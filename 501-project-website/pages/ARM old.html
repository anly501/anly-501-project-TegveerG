<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>arm</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
    overflow: hidden;
    background-color: #041E42;
    max-width:1500px;
    height: 50px;
    font-size: small;
}

li {
    float: left;
    display: inline;
    vertical-align: middle;
}

li a, .dropbtn {
    display: inline-block;
    color: #D6D2C4;
    text-align: center;
    padding: 14px 16px;
    text-decoration: underline;
    font-weight: bold;
    outline: 0;
}

li a:hover, .dropdown:hover .dropbtn {
    background-color: #ffffff;
    z-index: 99;
}

li.dropdown {
    display: inline-block;
    z-index: 99;
}

.dropdown-content {
    display: none;
    position: absolute;
    background-color: #D6D2C4;
    min-width: 160px;   
}

.dropdown-content a {
    color: #000000;
    padding: 12px 16px;
    text-decoration: italic;
    display: block;
    text-align: left;
}

.dropdown:hover .dropdown-content {
    display: block;
    opacity: .6;

}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="ARM_files/libs/clipboard/clipboard.min.js"></script>
<script src="ARM_files/libs/quarto-html/quarto.js"></script>
<script src="ARM_files/libs/quarto-html/popper.min.js"></script>
<script src="ARM_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="ARM_files/libs/quarto-html/anchor.min.js"></script>
<link href="ARM_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="ARM_files/libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="ARM_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="ARM_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="ARM_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

  <a href="https://analytics.georgetown.edu/" target="_blank">
    <img src="../../501-project-website/images/DSAN.jpeg" style="width:650px;height:200px;">
  </a>

  <a>
    <img src="../../501-project-website/images/healy_hall.jpeg" style="width:650px;height:200px;align-items: right;">
  </a>

  <a>
    <img src="../../501-project-website/images/Jack.jpeg" style="width: 180px;height:200px;align-items: right;">
  </a>


<ul>
  <!-- link back to homepage -->
  <li>
  <a href="../../501-project-website/index.html">About Me</a>
  </li>
  <li>
    <a href="https://github.com/anly501/anly-501-project-TegveerG/tree/main/codes/">Code</a>
</li>
<li>
  <a href="https://github.com/anly501/anly-501-project-TegveerG/tree/main/data">Data</a>
</li>
  <!-- tab without dropdown  -->
  <li>
  <a href="../../501-project-website/pages/Introduction.html">Introduction</a>
  </li>
  <!-- tab without dropdown  -->
  <li>
  <a href="../../501-project-website/pages/Data Gathering.html">Data Gathering</a>
  </li>
  <!-- tab without dropdown  -->
  <li>
  <a href="../../501-project-website/pages/Data-Cleaning-rmd.html">Data Cleaning</a>
  </li>
  <!-- tab without dropdown  -->
  <li>
  <a href="../../501-project-website/pages/Exploring-Data-rmd.html">Exploring Data</a>
  </li>
  <!-- tab without dropdown  -->
  <li>
  <a href="../../501-project-website/pages/Naive-Bayes-R.html">Naive Bayes</a>
  </li>
  <!-- tab without dropdown  -->
  <li>
  <a href="../../501-project-website/pages/decision_tree_record_data.html">Decision Trees</a>
  </li>
  <!-- tab without dropdown  -->
  <li>
  <a href="../../501-project-website/pages/svm_text_data.html">SVM</a>
  </li>
  <!-- tab without dropdown  -->
  <li>
  <a href="../../501-project-website/pages/clustering.html">Clustering</a>
  </li>
  <!-- tab without dropdown  -->
  <li>
  <a href="../../501-project-website/pages/ARM and Networking.html">ARM and Networking</a>
  </li>
  <!-- tab without dropdown  -->
  <li>
  <a href="../../501-project-website/pages/Conclusions.html">Conclusions</a>
  </li>
  </ul>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">



<section id="association-rule-mining-with-record-data-rekt-database" class="level1">
<h1>Association Rule Mining with Record Data (REKT Database)</h1>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>For ARM analysis, we shall use the cleaned REKT Database that we used for classification analysis. Like clustering analysis, ARM does not require a response variable beacuse it is an unsupervised machine learning method. However, unlike clustering, we do not drop the target variable (Y) of scam_type_grouped for ARM and treat it as a feature. Moreover, we will use the categorical variables month_of_attack and day_of_week_of_attack as two additional features. For simplicity, the day_of_year_of_attack variable shall be dropped because month_of_attack and day_of_week_of_attack convey enough information for datetime features. Additionally, because ARM requires all variables to be categorical, we shall convert the log funds (lost and returned) variables into their original dollar values and discretize them for accurate analysis.</p>
<p>The feature data (X) that we will eventually be left with will contain 6 record features, including two features of discretized funds (lost and returned), two datetime extracted features of month_of_attack and day_of_week_of_attack, and two categorical variables scamNetworks, which denotes the type of project or token associated with the attack, and scam_type_grouped, which denotes the type of attack (Exit Scam or Exploit). By the end of the analysis, we will showcase how these six variables relate with each other in terms of the rules generated by the Apriori Algorithm. We shall also make use of the support, confidence, and lift metrics to analyse the results of the network.</p>
</section>
<section id="theory" class="level2">
<h2 class="anchored" data-anchor-id="theory">Theory</h2>
<section id="association-rule-mining-arm-and-the-apriori-algorithm" class="level4">
<h4 class="anchored" data-anchor-id="association-rule-mining-arm-and-the-apriori-algorithm">Association Rule Mining (ARM) and the Apriori Algorithm</h4>
<p>ARM is an unsupervised rule-based machine learning method that learns associations among item-sets or attributes. An item-set is a collection of attribute values that appears in one or more training examples. The rules take the form of “if-then” statements, including a precondition and conclusion. Format: If precondition, Then conclusion (If A -&gt; Then B, where A and B is an item-set). We can also obtain the converse of a rule by swapping the precondition and conclusion. ARM’s goal is to find rules (i.e.&nbsp;a model), given a set of transactions (training data), that will predict the occurrence of an item based on the occurrences of other items in the training data. To further understand how these rules are generated we must understand three metrics of a rule:</p>
<ol type="1">
<li>Support: The popularity of an item set as measured by the proportion of transactions in which an item-set appears. Or, given a rule <span class="math inline">\(A \Rightarrow B, Support(A, B) = P(A \cap B) = \frac{\text{number of transactions containing A and B}}{\text{total number of transactions}}\)</span>, where A and B are separate item sets that occur in at the same time in a transaction. Therefore, the support denotes how often items with A and items in B occur together relative to all other transactions. Support takes on values between 0 and 1, where 1 signifies that the item-set is highly important and 0 signifies irrelevance. For larger datasets, we prune the number of rules we shall consider by limiting ourselves with a sufficient support threshold.</li>
<li>Confidence: If the precondition holds true, how likely is it that the conclusion also holds? Therefore, <span class="math inline">\(Confidence(A \Rightarrow B) = P(B|A) = \frac{support(A \cap B)}{support(A)} = \frac{\text{number of transactions containing A and B}}{\text{number of transactions containing A}}\)</span>. In words, confidence measures how often items in A and items in B occur together, relative to transactions that contain A. Confidence gauges how statistically “strong” a rule is and, like support, it takes on values between 0 and 1, where 1 indicates that B is bought everytime A is and 0 indicates no instance of the respective rule occuring.</li>
<li>Lift: How likely item B is present when item A is present, while controlling for how popular item B is. Therefore, <span class="math inline">\(Lift(A \Rightarrow B) = \frac{support(A \cap B)}{support(A) * support(B)}\)</span>, given that A and B are independent. A lift value of 1 represents no associations between item-sets, so no rule can be drawn involving those item-sets. A lift value greater than 1 represents a positive relation between the items or, simply put, a dependence on one another. Whereas a lift value lesser than 1 represents negative relation between the items or a substitution effect between them.</li>
</ol>
<p><em>It is also important to keep in mind that support does not change when we permute items in the item-set!</em></p>
<p>The Apriori Algorithm helps learn association rules and can be divided into 2 stages: 1. Gradually build up larger and larger item-sets that have sufficient support using a threshold 2. Form rules from item-sets by keeping those that have high enough confidence Therefore, if we have n unique items, we obtain <span class="math inline">\(2^n\)</span> total number of item-sets and <span class="math inline">\(3^n - 2^{n+1} + 1\)</span> total possible association rules</p>
</section>
</section>
<section id="methods" class="level2">
<h2 class="anchored" data-anchor-id="methods">Methods</h2>
<section id="data-selection" class="level3">
<h3 class="anchored" data-anchor-id="data-selection">Data Selection</h3>
<div class="cell" data-execution_count="1">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import the necessary packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>sns.set_theme(style<span class="op">=</span><span class="st">"whitegrid"</span>, palette<span class="op">=</span><span class="st">'Set2'</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">"ignore"</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> apyori <span class="im">import</span> apriori</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> networkx <span class="im">as</span> nx </span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># read in cleaned REKT Database and drop labels and other variables, leaving only feature data (X)</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">"../../data/Clean Data/REKT_Database_Clean_Classification.csv"</span>, index_col<span class="op">=</span>[<span class="dv">0</span>])</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>df_arm <span class="op">=</span> df.drop([<span class="st">'day_of_year_of_attack'</span>], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>df_arm.head() <span class="co"># visualize first 5 rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="1">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>log_funds_lost</th>
      <th>log_funds_returned</th>
      <th>scamNetworks</th>
      <th>month_of_attack</th>
      <th>day_of_week_of_attack</th>
      <th>scam_type_grouped</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>15.319588</td>
      <td>0.0</td>
      <td>Ethereum</td>
      <td>8</td>
      <td>6</td>
      <td>Exploit</td>
    </tr>
    <tr>
      <th>2</th>
      <td>10.603213</td>
      <td>0.0</td>
      <td>Avax</td>
      <td>5</td>
      <td>1</td>
      <td>Exit Scam</td>
    </tr>
    <tr>
      <th>3</th>
      <td>15.420940</td>
      <td>0.0</td>
      <td>CEX</td>
      <td>4</td>
      <td>5</td>
      <td>Exploit</td>
    </tr>
    <tr>
      <th>4</th>
      <td>13.504419</td>
      <td>0.0</td>
      <td>Binance</td>
      <td>7</td>
      <td>2</td>
      <td>Exit Scam</td>
    </tr>
    <tr>
      <th>5</th>
      <td>9.798127</td>
      <td>0.0</td>
      <td>Fantom</td>
      <td>5</td>
      <td>5</td>
      <td>Exploit</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="2">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'day_of_week_of_attack'</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>1    128
2    120
0    118
6    114
5    113
4    112
3    111
Name: day_of_week_of_attack, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="3">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>df_arm.shape <span class="co"># get the number of rows and columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>(816, 6)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="4">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_arm.info()) <span class="co"># get column information</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Int64Index: 816 entries, 1 to 816
Data columns (total 6 columns):
 #   Column                 Non-Null Count  Dtype  
---  ------                 --------------  -----  
 0   log_funds_lost         816 non-null    float64
 1   log_funds_returned     816 non-null    float64
 2   scamNetworks           816 non-null    object 
 3   month_of_attack        816 non-null    int64  
 4   day_of_week_of_attack  816 non-null    int64  
 5   scam_type_grouped      816 non-null    object 
dtypes: float64(2), int64(2), object(2)
memory usage: 44.6+ KB
None</code></pre>
</div>
</div>
<div class="cell" data-execution_count="5">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>df_arm.isnull().<span class="bu">sum</span>() <span class="co"># check for missing values</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>log_funds_lost           0
log_funds_returned       0
scamNetworks             0
month_of_attack          0
day_of_week_of_attack    0
scam_type_grouped        0
dtype: int64</code></pre>
</div>
</div>
</section>
<section id="feature-selection-and-pre-processing" class="level3">
<h3 class="anchored" data-anchor-id="feature-selection-and-pre-processing">Feature selection and Pre-processing</h3>
<p>We will first convert the log funds and log returned variables into their original values using numpy’s exponential function. To convert the funds variables into categorical, we shall discretize them into the following values: “Billions <span class="math inline">\(\Rightarrow\)</span> funds <span class="math inline">\(\geq\)</span> 1,000,000,000”, “High Millions <span class="math inline">\(\Rightarrow\)</span> 1000000000 <span class="math inline">\(\leq\)</span> funds <span class="math inline">\(\geq\)</span> 500000000”, “Low Millions <span class="math inline">\(\Rightarrow\)</span> 500000000 <span class="math inline">\(\leq\)</span> funds <span class="math inline">\(\geq\)</span> 1000000”, “High 100K’s <span class="math inline">\(\Rightarrow\)</span> 1000000 <span class="math inline">\(\leq\)</span> funds <span class="math inline">\(\geq\)</span> 500000”, “Low 100K’s <span class="math inline">\(\Rightarrow\)</span> 500000 <span class="math inline">\(\leq\)</span> funds <span class="math inline">\(\geq\)</span> 100000”, “Less Than 100K <span class="math inline">\(\Rightarrow\)</span> 100000 <span class="math inline">\(\leq\)</span> funds”. Also, for the funds returned variable, because around 90% of values contain $0 being returned for an attack, we will add a “No Funds Returned” category.</p>
<p>We shall also add names of months and days for the respective date time features, instead of keeping the numeric categories, for easier interpretation of the network. Lastly, we shall drop the log funds and original funds variables to keep only the discretized string variables for funds lost and funds returned.</p>
<div class="cell" data-execution_count="6">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>df_arm[<span class="st">'funds_lost_USD'</span>] <span class="op">=</span> np.exp(df_arm[<span class="st">'log_funds_lost'</span>]).<span class="bu">round</span>()</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>df_arm[<span class="st">'funds_returned_USD'</span>] <span class="op">=</span> np.exp(df_arm[<span class="st">'log_funds_returned'</span>]).<span class="bu">round</span>() <span class="op">-</span> <span class="dv">1</span> <span class="co"># subtract 1 because we had zeros in funds_returned that avoided negative inf values when converting to log</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> assign_funds_lost_val(row):</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> row <span class="op">&gt;=</span> <span class="dv">1000000000</span>:</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">'FL Billions'</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> row <span class="op">&gt;=</span> <span class="dv">500000000</span> <span class="kw">and</span> row <span class="op">&lt;</span> <span class="dv">1000000000</span>:</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">'FL High Millions'</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> row <span class="op">&gt;=</span> <span class="dv">1000000</span> <span class="kw">and</span> row <span class="op">&lt;</span> <span class="dv">500000000</span>:</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">'FL Low Millions'</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> row <span class="op">&gt;=</span> <span class="dv">500000</span> <span class="kw">and</span> row <span class="op">&lt;</span> <span class="dv">1000000</span>:</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">"FL High 100K's"</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> row <span class="op">&gt;=</span> <span class="dv">100000</span> <span class="kw">and</span> row <span class="op">&lt;</span> <span class="dv">500000</span>:</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">"FL Low 100K's"</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">"FL Less Than 100K"</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>df_arm[<span class="st">'funds_lost_USD_discretized'</span>] <span class="op">=</span> df_arm[<span class="st">'funds_lost_USD'</span>].<span class="bu">apply</span>(assign_funds_lost_val)</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> assign_funds_ret_val(row):</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> row <span class="op">&gt;=</span> <span class="dv">1000000000</span>:</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">'FR Billions'</span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> row <span class="op">&gt;=</span> <span class="dv">500000000</span> <span class="kw">and</span> row <span class="op">&lt;</span> <span class="dv">1000000000</span>:</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">'FR High Millions'</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> row <span class="op">&gt;=</span> <span class="dv">1000000</span> <span class="kw">and</span> row <span class="op">&lt;</span> <span class="dv">500000000</span>:</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">'FR Low Millions'</span></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> row <span class="op">&gt;=</span> <span class="dv">500000</span> <span class="kw">and</span> row <span class="op">&lt;</span> <span class="dv">1000000</span>:</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">"FR High 100K's"</span></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> row <span class="op">&gt;=</span> <span class="dv">100000</span> <span class="kw">and</span> row <span class="op">&lt;</span> <span class="dv">500000</span>:</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">"FR Low 100K's"</span></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> row <span class="op">&gt;</span> <span class="dv">0</span> <span class="kw">and</span> row <span class="op">&lt;</span> <span class="dv">100000</span>:</span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">"FR Less Than 100K (&gt;0)"</span></span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">"No Funds Returned"</span></span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result</span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>df_arm[<span class="st">'funds_returned_USD_discretized'</span>] <span class="op">=</span> df_arm[<span class="st">'funds_returned_USD'</span>].<span class="bu">apply</span>(assign_funds_ret_val)</span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> assign_month(row):</span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> row <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">'January'</span></span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> row <span class="op">==</span> <span class="dv">2</span>:</span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">'February'</span></span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> row <span class="op">==</span> <span class="dv">3</span>:</span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">'March'</span></span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> row <span class="op">==</span> <span class="dv">4</span>:</span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">"April"</span></span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> row <span class="op">==</span> <span class="dv">5</span>:</span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">"May"</span></span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> row <span class="op">==</span> <span class="dv">6</span>:</span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">"June"</span></span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> row <span class="op">==</span> <span class="dv">7</span>:</span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">"July"</span></span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> row <span class="op">==</span> <span class="dv">8</span>:</span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">"August"</span></span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> row <span class="op">==</span> <span class="dv">9</span>:</span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">"September"</span></span>
<span id="cb10-62"><a href="#cb10-62" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> row <span class="op">==</span> <span class="dv">10</span>:</span>
<span id="cb10-63"><a href="#cb10-63" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">"October"</span></span>
<span id="cb10-64"><a href="#cb10-64" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> row <span class="op">==</span> <span class="dv">11</span>:</span>
<span id="cb10-65"><a href="#cb10-65" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">"October"</span></span>
<span id="cb10-66"><a href="#cb10-66" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb10-67"><a href="#cb10-67" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">"December"</span></span>
<span id="cb10-68"><a href="#cb10-68" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result</span>
<span id="cb10-69"><a href="#cb10-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-70"><a href="#cb10-70" aria-hidden="true" tabindex="-1"></a>df_arm[<span class="st">'month_of_attack'</span>] <span class="op">=</span> df_arm[<span class="st">'month_of_attack'</span>].<span class="bu">apply</span>(assign_month)</span>
<span id="cb10-71"><a href="#cb10-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-72"><a href="#cb10-72" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> assign_dow(row):</span>
<span id="cb10-73"><a href="#cb10-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-74"><a href="#cb10-74" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> row <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb10-75"><a href="#cb10-75" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">'Monday'</span></span>
<span id="cb10-76"><a href="#cb10-76" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> row <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb10-77"><a href="#cb10-77" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">'Tuesday'</span></span>
<span id="cb10-78"><a href="#cb10-78" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> row <span class="op">==</span> <span class="dv">2</span>:</span>
<span id="cb10-79"><a href="#cb10-79" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">'Wednesday'</span></span>
<span id="cb10-80"><a href="#cb10-80" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> row <span class="op">==</span> <span class="dv">3</span>:</span>
<span id="cb10-81"><a href="#cb10-81" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">"Thursday"</span></span>
<span id="cb10-82"><a href="#cb10-82" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> row <span class="op">==</span> <span class="dv">4</span>:</span>
<span id="cb10-83"><a href="#cb10-83" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">"Friday"</span></span>
<span id="cb10-84"><a href="#cb10-84" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> row <span class="op">==</span> <span class="dv">5</span>:</span>
<span id="cb10-85"><a href="#cb10-85" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">"Saturday"</span></span>
<span id="cb10-86"><a href="#cb10-86" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb10-87"><a href="#cb10-87" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">"Sunday"</span></span>
<span id="cb10-88"><a href="#cb10-88" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result</span>
<span id="cb10-89"><a href="#cb10-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-90"><a href="#cb10-90" aria-hidden="true" tabindex="-1"></a>df_arm[<span class="st">'day_of_week_of_attack'</span>] <span class="op">=</span> df_arm[<span class="st">'day_of_week_of_attack'</span>].<span class="bu">apply</span>(assign_dow)</span>
<span id="cb10-91"><a href="#cb10-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-92"><a href="#cb10-92" aria-hidden="true" tabindex="-1"></a>df_arm <span class="op">=</span> df_arm.drop([<span class="st">'log_funds_lost'</span>, <span class="st">'log_funds_returned'</span>, <span class="st">'funds_lost_USD'</span>, <span class="st">'funds_returned_USD'</span>], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb10-93"><a href="#cb10-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-94"><a href="#cb10-94" aria-hidden="true" tabindex="-1"></a>df_arm.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="6">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>scamNetworks</th>
      <th>month_of_attack</th>
      <th>day_of_week_of_attack</th>
      <th>scam_type_grouped</th>
      <th>funds_lost_USD_discretized</th>
      <th>funds_returned_USD_discretized</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>Ethereum</td>
      <td>August</td>
      <td>Sunday</td>
      <td>Exploit</td>
      <td>FL Low Millions</td>
      <td>No Funds Returned</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Avax</td>
      <td>May</td>
      <td>Tuesday</td>
      <td>Exit Scam</td>
      <td>FL Less Than 100K</td>
      <td>No Funds Returned</td>
    </tr>
    <tr>
      <th>3</th>
      <td>CEX</td>
      <td>April</td>
      <td>Saturday</td>
      <td>Exploit</td>
      <td>FL Low Millions</td>
      <td>No Funds Returned</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Binance</td>
      <td>July</td>
      <td>Wednesday</td>
      <td>Exit Scam</td>
      <td>FL High 100K's</td>
      <td>No Funds Returned</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Fantom</td>
      <td>May</td>
      <td>Saturday</td>
      <td>Exploit</td>
      <td>FL Less Than 100K</td>
      <td>No Funds Returned</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="7">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>df_arm[<span class="st">'funds_returned_USD_discretized'</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>No Funds Returned         751
FR Low Millions            42
FR Low 100K's              10
FR Less Than 100K (&gt;0)      6
FR High 100K's              5
FR High Millions            2
Name: funds_returned_USD_discretized, dtype: int64</code></pre>
</div>
</div>
<p>The above table shows us the frequency of each discretized numeric value for funds returned (USD). Almost 90% of attacks did not result in funds being returned to the respective cyryptocurrency project or chain. Keeping this factor in mind, we shall create 2 Apriori Algorithm models, one with with no funds returned and one without.</p>
<div class="cell" data-execution_count="8">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># CONVERT THE DATA FRAME TO A LIST OF LISTS</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>transactions <span class="op">=</span> []</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, df_arm.shape[<span class="dv">0</span>]):</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    transaction<span class="op">=</span>[]</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, df_arm.shape[<span class="dv">1</span>]):</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(<span class="bu">str</span>(df_arm.iloc[i,j]) <span class="op">!=</span> <span class="st">"nan"</span>):</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>            transaction.append(df_arm.iloc[i,j])</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    transactions.append(transaction)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co">#print(transactions)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
<section id="utility-function-re-format-output" class="level1">
<h1>Utility function: Re-format output</h1>
<div class="cell" data-execution_count="9">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> apyori <span class="im">import</span> apriori</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reformat_results(results):</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">#CLEAN-UP RESULTS </span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    keep<span class="op">=</span>[]</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>,<span class="bu">len</span>(results)):</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>        <span class="co"># print("=====================================")</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># print(results[i])</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># print(len(list(results[i])))</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>,<span class="bu">len</span>(<span class="bu">list</span>(results[i]))):</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>            <span class="co"># print(results)</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span>(j<span class="op">&gt;</span><span class="dv">1</span>):</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>,<span class="bu">len</span>(<span class="bu">list</span>(results[i][j]))):</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span>(<span class="bu">len</span>(results[i][j][k][<span class="dv">0</span>])<span class="op">!=</span><span class="dv">0</span>):</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>                        <span class="co">#print(len(results[i][j][k][0]),results[i][j][k][0])</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>                        rhs<span class="op">=</span><span class="bu">list</span>(results[i][j][k][<span class="dv">0</span>])</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>                        lhs<span class="op">=</span><span class="bu">list</span>(results[i][j][k][<span class="dv">1</span>])</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>                        conf<span class="op">=</span><span class="bu">float</span>(results[i][j][k][<span class="dv">2</span>])</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>                        lift<span class="op">=</span><span class="bu">float</span>(results[i][j][k][<span class="dv">3</span>])</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>                        keep.append([rhs,lhs,supp,conf,supp<span class="op">*</span>conf,lift])</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># keep.append()</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span>(j<span class="op">==</span><span class="dv">1</span>):</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>                supp<span class="op">=</span>results[i][j]</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pd.DataFrame(keep, columns <span class="op">=</span>[<span class="st">"rhs"</span>,<span class="st">"lhs"</span>,<span class="st">"supp"</span>,<span class="st">"conf"</span>,<span class="st">"supp x conf"</span>,<span class="st">"lift"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="utility-function-convert-to-networkx-object" class="level1">
<h1>Utility function: Convert to NetworkX object</h1>
<div class="cell" data-execution_count="10">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_to_network(df):</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(df)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">#BUILD GRAPH</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    G <span class="op">=</span> nx.DiGraph()  <span class="co"># DIRECTED</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> row <span class="kw">in</span> df.iterrows():</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>        <span class="co"># for column in df.columns:</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>        lhs<span class="op">=</span><span class="st">"_"</span>.join(row[<span class="dv">1</span>][<span class="dv">0</span>])</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>        rhs<span class="op">=</span><span class="st">"_"</span>.join(row[<span class="dv">1</span>][<span class="dv">1</span>])</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>        conf<span class="op">=</span>row[<span class="dv">1</span>][<span class="dv">3</span>]<span class="op">;</span> <span class="co">#print(conf)</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(lhs <span class="kw">not</span> <span class="kw">in</span> G.nodes): </span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>            G.add_node(lhs)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(rhs <span class="kw">not</span> <span class="kw">in</span> G.nodes): </span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>            G.add_node(rhs)</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>        edge<span class="op">=</span>(lhs,rhs)</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> edge <span class="kw">not</span> <span class="kw">in</span> G.edges:</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>            G.add_edge(lhs, rhs, weight<span class="op">=</span>conf)</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print(G.nodes)</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print(G.edges)</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> G</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="utility-function-plot-networkx-object" class="level1">
<h1>Utility function: Plot NetworkX object</h1>
<div class="cell" data-execution_count="11">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_network(G):</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">#SPECIFIY X-Y POSITIONS FOR PLOTTING</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    pos<span class="op">=</span>nx.random_layout(G)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">#GENERATE PLOT</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    fig.set_size_inches(<span class="dv">15</span>, <span class="dv">15</span>)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">#assign colors based on attributes</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    weights_e   <span class="op">=</span> [G[u][v][<span class="st">'weight'</span>] <span class="cf">for</span> u,v <span class="kw">in</span> G.edges()]</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">#SAMPLE CMAP FOR COLORS </span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    cmap<span class="op">=</span>plt.cm.get_cmap(<span class="st">'Blues'</span>)</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>    colors_e    <span class="op">=</span> [cmap(G[u][v][<span class="st">'weight'</span>]<span class="op">/</span><span class="fl">5.0</span>) <span class="cf">for</span> u,v <span class="kw">in</span> G.edges()]</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">#PLOT</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>    nx.draw(</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>    G,</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>    edgecolors<span class="op">=</span><span class="st">"black"</span>,</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>    edge_color<span class="op">=</span>colors_e,</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>    node_size<span class="op">=</span><span class="dv">3000</span>,</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>    linewidths<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>    font_size<span class="op">=</span><span class="dv">8</span>,</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>    font_color<span class="op">=</span><span class="st">"red"</span>,</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>    font_weight<span class="op">=</span><span class="st">"bold"</span>,</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>    width<span class="op">=</span>weights_e,</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>    with_labels<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>    pos<span class="op">=</span>pos,</span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>    ax<span class="op">=</span>ax</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>    nx.spring_layout(G, <span class="dv">1</span><span class="op">/</span><span class="dv">5</span>)</span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>    ax.<span class="bu">set</span>(title<span class="op">=</span><span class="st">'REKT Database ARM Network Graph'</span>)</span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ax.set_aspect('equal', 'box')</span></span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># plt.colorbar(cmap)</span></span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># fig.savefig("test.png")</span></span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="perform-apriori-algorithm" class="level1">
<h1>Perform Apriori Algorithm</h1>
<div class="cell" data-execution_count="12">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Transactions:"</span>,pd.DataFrame(transactions))</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> <span class="bu">list</span>(apriori(transactions, min_support<span class="op">=</span><span class="fl">0.15</span>, min_confidence<span class="op">=</span><span class="fl">0.2</span>, min_length<span class="op">=</span><span class="dv">2</span>, max_length<span class="op">=</span><span class="dv">10</span>))     <span class="co">#RUN APRIORI ALGORITHM</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>pd_results<span class="op">=</span>reformat_results(results)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Results</span><span class="ch">\n</span><span class="st">"</span>,pd_results)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>G<span class="op">=</span>convert_to_network(pd_results)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>plot_network(G)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Transactions:             0        1          2          3                  4  \
0    Ethereum   August     Sunday    Exploit    FL Low Millions   
1        Avax      May    Tuesday  Exit Scam  FL Less Than 100K   
2         CEX    April   Saturday    Exploit    FL Low Millions   
3     Binance     July  Wednesday  Exit Scam     FL High 100K's   
4      Fantom      May   Saturday    Exploit  FL Less Than 100K   
..        ...      ...        ...        ...                ...   
811   Binance      May   Thursday    Exploit     FL High 100K's   
812       CEX    March     Sunday    Exploit      FL Low 100K's   
813   Polygon     July     Sunday    Exploit      FL Low 100K's   
814  Ethereum   August    Tuesday    Exploit    FL Low Millions   
815  Ethereum  October     Friday  Exit Scam  FL Less Than 100K   

                     5  
0    No Funds Returned  
1    No Funds Returned  
2    No Funds Returned  
3    No Funds Returned  
4    No Funds Returned  
..                 ...  
811  No Funds Returned  
812  No Funds Returned  
813      FR Low 100K's  
814  No Funds Returned  
815  No Funds Returned  

[816 rows x 6 columns]
Results
                                                   rhs                    lhs  \
0                                           [Binance]            [Exit Scam]   
1                                         [Exit Scam]              [Binance]   
2                                           [Binance]    [No Funds Returned]   
3                                 [No Funds Returned]              [Binance]   
4                                          [Ethereum]            [Exit Scam]   
..                                                ...                    ...   
70             [No Funds Returned, FL Less Than 100K]  [Exit Scam, Ethereum]   
71           [FL Less Than 100K, Exit Scam, Ethereum]    [No Funds Returned]   
72           [Exit Scam, Ethereum, No Funds Returned]    [FL Less Than 100K]   
73   [FL Less Than 100K, No Funds Returned, Ethereum]            [Exit Scam]   
74  [Exit Scam, FL Less Than 100K, No Funds Returned]             [Ethereum]   

        supp      conf  supp x conf      lift  
0   0.169118  0.577406     0.097650  1.236649  
1   0.169118  0.362205     0.061255  1.236649  
2   0.285539  0.974895     0.278371  1.059274  
3   0.285539  0.310253     0.088589  1.059274  
4   0.236520  0.559420     0.132314  1.198128  
..       ...       ...          ...       ...  
70  0.170343  0.534615     0.091068  2.260343  
71  0.170343  1.000000     0.170343  1.086551  
72  0.170343  0.720207     0.122682  2.226095  
73  0.170343  0.920530     0.156806  1.971528  
74  0.170343  0.661905     0.112751  1.565549  

[75 rows x 6 columns]
                                                  rhs                    lhs  \
0                                           [Binance]            [Exit Scam]   
1                                         [Exit Scam]              [Binance]   
2                                           [Binance]    [No Funds Returned]   
3                                 [No Funds Returned]              [Binance]   
4                                          [Ethereum]            [Exit Scam]   
..                                                ...                    ...   
70             [No Funds Returned, FL Less Than 100K]  [Exit Scam, Ethereum]   
71           [FL Less Than 100K, Exit Scam, Ethereum]    [No Funds Returned]   
72           [Exit Scam, Ethereum, No Funds Returned]    [FL Less Than 100K]   
73   [FL Less Than 100K, No Funds Returned, Ethereum]            [Exit Scam]   
74  [Exit Scam, FL Less Than 100K, No Funds Returned]             [Ethereum]   

        supp      conf  supp x conf      lift  
0   0.169118  0.577406     0.097650  1.236649  
1   0.169118  0.362205     0.061255  1.236649  
2   0.285539  0.974895     0.278371  1.059274  
3   0.285539  0.310253     0.088589  1.059274  
4   0.236520  0.559420     0.132314  1.198128  
..       ...       ...          ...       ...  
70  0.170343  0.534615     0.091068  2.260343  
71  0.170343  1.000000     0.170343  1.086551  
72  0.170343  0.720207     0.122682  2.226095  
73  0.170343  0.920530     0.156806  1.971528  
74  0.170343  0.661905     0.112751  1.565549  

[75 rows x 6 columns]</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="ARM_files/figure-html/cell-13-output-2.png" width="1135" height="1148"></p>
</div>
</div>
<p>According to the above NetworkX graph and table of metrics, we see that a lot of rules, with lift &gt; 1, were formed for no funds returned (USD). I also chose a minimum confidence threshold of 0.2 to include date time features in the graph. A confidence threshold of higher than that eliminates the date time features, which means that rules including date time item-sets get pruned due to their low associations with funds lost and returned. The graph provides insights about the Ethereum and Binance cryptocurrency platforms losing funds in the low 100 thousand’s ($100,000 to $500,000) and low millions ($1,000,000 to $500,000,000) that led to no funds being returned. Because no funds returned is a majority category of the data (almost 90%), we obtained these rules that were dominated with no funds returned.</p>
<p>In terms of the datetime features, weekends are more likely to be associated with attacks than weekdays are. Let’s see what other insights can be generated if we filter out values where no funds were returned…</p>
<section id="apriori-algorithm-after-filtering-no-funds-returned-values" class="level3">
<h3 class="anchored" data-anchor-id="apriori-algorithm-after-filtering-no-funds-returned-values">Apriori Algorithm After Filtering No Funds Returned Values</h3>
<div class="cell" data-execution_count="13">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>df_arm_flitered <span class="op">=</span> df_arm.query(<span class="st">"funds_returned_USD_discretized != 'No Funds Returned'"</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_arm_flitered.shape)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># CONVERT THE DATA FRAME TO A LIST OF LISTS</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>transactions <span class="op">=</span> []</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, df_arm_flitered.shape[<span class="dv">0</span>]):</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    transaction<span class="op">=</span>[]</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, df_arm_flitered.shape[<span class="dv">1</span>]):</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(<span class="bu">str</span>(df_arm_flitered.iloc[i,j]) <span class="op">!=</span> <span class="st">"nan"</span>):</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>            transaction.append(df_arm_flitered.iloc[i,j])</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>    transactions.append(transaction)</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="co">#print(transactions)</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Transactions:"</span>,pd.DataFrame(transactions))</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> <span class="bu">list</span>(apriori(transactions, min_support<span class="op">=</span><span class="fl">0.15</span>, min_confidence<span class="op">=</span><span class="fl">0.1</span>, min_length<span class="op">=</span><span class="dv">2</span>, max_length<span class="op">=</span><span class="dv">5</span>))     <span class="co">#RUN APRIORI ALGORITHM</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>pd_results<span class="op">=</span>reformat_results(results)</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Results</span><span class="ch">\n</span><span class="st">"</span>,pd_results)</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>G<span class="op">=</span>convert_to_network(pd_results)</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>plot_network(G)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(65, 6)
Transactions:            0         1          2        3                  4  \
0   Ethereum      July     Sunday  Exploit      FL Low 100K's   
1        CEX     March    Tuesday  Exploit  FL Less Than 100K   
2   Ethereum      June     Sunday  Exploit    FL Low Millions   
3   Ethereum  February   Saturday  Exploit    FL Low Millions   
4      Other     April     Friday  Exploit      FL Low 100K's   
..       ...       ...        ...      ...                ...   
60  Ethereum   January    Tuesday  Exploit    FL Low Millions   
61   Binance      June    Tuesday  Exploit    FL Low Millions   
62    Solana  February  Wednesday  Exploit    FL Low Millions   
63   Binance   October   Saturday  Exploit    FL Low Millions   
64   Polygon      July     Sunday  Exploit      FL Low 100K's   

                         5  
0            FR Low 100K's  
1   FR Less Than 100K (&gt;0)  
2          FR Low Millions  
3          FR Low Millions  
4   FR Less Than 100K (&gt;0)  
..                     ...  
60         FR Low Millions  
61         FR Low Millions  
62         FR Low Millions  
63         FR Low Millions  
64           FR Low 100K's  

[65 rows x 6 columns]
Results
                                              rhs  \
0                                          [CEX]   
1                                      [Exploit]   
2                                     [Ethereum]   
3                                      [Exploit]   
4                                     [Ethereum]   
5                              [FL Low Millions]   
6                                     [Ethereum]   
7                              [FR Low Millions]   
8                                      [Exploit]   
9                              [FL Low Millions]   
10                                     [Exploit]   
11                             [FR Low Millions]   
12                                     [Exploit]   
13                                      [Friday]   
14                                     [Exploit]   
15                                    [Saturday]   
16                                     [Exploit]   
17                                      [Sunday]   
18                                     [Exploit]   
19                                     [Tuesday]   
20                             [FL Low Millions]   
21                             [FR Low Millions]   
22                                    [Ethereum]   
23                                     [Exploit]   
24                             [FL Low Millions]   
25                           [Exploit, Ethereum]   
26                   [Ethereum, FL Low Millions]   
27                    [Exploit, FL Low Millions]   
28                                    [Ethereum]   
29                                     [Exploit]   
30                             [FR Low Millions]   
31                           [Exploit, Ethereum]   
32                   [FR Low Millions, Ethereum]   
33                    [Exploit, FR Low Millions]   
34                                    [Ethereum]   
35                             [FL Low Millions]   
36                             [FR Low Millions]   
37                   [Ethereum, FL Low Millions]   
38                   [FR Low Millions, Ethereum]   
39            [FR Low Millions, FL Low Millions]   
40                                     [Exploit]   
41                             [FL Low Millions]   
42                             [FR Low Millions]   
43                    [Exploit, FL Low Millions]   
44                    [Exploit, FR Low Millions]   
45            [FR Low Millions, FL Low Millions]   
46                                    [Ethereum]   
47                                     [Exploit]   
48                             [FL Low Millions]   
49                             [FR Low Millions]   
50                           [Exploit, Ethereum]   
51                   [Ethereum, FL Low Millions]   
52                   [FR Low Millions, Ethereum]   
53                    [Exploit, FL Low Millions]   
54                    [Exploit, FR Low Millions]   
55            [FR Low Millions, FL Low Millions]   
56          [Exploit, Ethereum, FL Low Millions]   
57          [Exploit, Ethereum, FR Low Millions]   
58  [FR Low Millions, Ethereum, FL Low Millions]   
59   [Exploit, FL Low Millions, FR Low Millions]   

                                             lhs      supp      conf  \
0                                      [Exploit]  0.153846  0.909091   
1                                          [CEX]  0.153846  0.161290   
2                                      [Exploit]  0.476923  1.000000   
3                                     [Ethereum]  0.476923  0.500000   
4                              [FL Low Millions]  0.323077  0.677419   
5                                     [Ethereum]  0.323077  0.488372   
6                              [FR Low Millions]  0.292308  0.612903   
7                                     [Ethereum]  0.292308  0.452381   
8                              [FL Low Millions]  0.646154  0.677419   
9                                      [Exploit]  0.646154  0.976744   
10                             [FR Low Millions]  0.615385  0.645161   
11                                     [Exploit]  0.615385  0.952381   
12                                      [Friday]  0.153846  0.161290   
13                                     [Exploit]  0.153846  0.909091   
14                                    [Saturday]  0.153846  0.161290   
15                                     [Exploit]  0.153846  1.000000   
16                                      [Sunday]  0.184615  0.193548   
17                                     [Exploit]  0.184615  1.000000   
18                                     [Tuesday]  0.184615  0.193548   
19                                     [Exploit]  0.184615  1.000000   
20                             [FR Low Millions]  0.615385  0.930233   
21                             [FL Low Millions]  0.615385  0.952381   
22                    [Exploit, FL Low Millions]  0.323077  0.677419   
23                   [Ethereum, FL Low Millions]  0.323077  0.338710   
24                           [Exploit, Ethereum]  0.323077  0.488372   
25                             [FL Low Millions]  0.323077  0.677419   
26                                     [Exploit]  0.323077  1.000000   
27                                    [Ethereum]  0.323077  0.500000   
28                    [Exploit, FR Low Millions]  0.292308  0.612903   
29                   [FR Low Millions, Ethereum]  0.292308  0.306452   
30                           [Exploit, Ethereum]  0.292308  0.452381   
31                             [FR Low Millions]  0.292308  0.612903   
32                                     [Exploit]  0.292308  1.000000   
33                                    [Ethereum]  0.292308  0.475000   
34            [FR Low Millions, FL Low Millions]  0.292308  0.612903   
35                   [FR Low Millions, Ethereum]  0.292308  0.441860   
36                   [Ethereum, FL Low Millions]  0.292308  0.452381   
37                             [FR Low Millions]  0.292308  0.904762   
38                             [FL Low Millions]  0.292308  1.000000   
39                                    [Ethereum]  0.292308  0.475000   
40            [FR Low Millions, FL Low Millions]  0.600000  0.629032   
41                    [Exploit, FR Low Millions]  0.600000  0.906977   
42                    [Exploit, FL Low Millions]  0.600000  0.928571   
43                             [FR Low Millions]  0.600000  0.928571   
44                             [FL Low Millions]  0.600000  0.975000   
45                                     [Exploit]  0.600000  0.975000   
46   [Exploit, FL Low Millions, FR Low Millions]  0.292308  0.612903   
47  [FR Low Millions, Ethereum, FL Low Millions]  0.292308  0.306452   
48          [Exploit, Ethereum, FR Low Millions]  0.292308  0.441860   
49          [Exploit, Ethereum, FL Low Millions]  0.292308  0.452381   
50            [FR Low Millions, FL Low Millions]  0.292308  0.612903   
51                    [Exploit, FR Low Millions]  0.292308  0.904762   
52                    [Exploit, FL Low Millions]  0.292308  1.000000   
53                   [FR Low Millions, Ethereum]  0.292308  0.452381   
54                   [Ethereum, FL Low Millions]  0.292308  0.475000   
55                           [Exploit, Ethereum]  0.292308  0.475000   
56                             [FR Low Millions]  0.292308  0.904762   
57                             [FL Low Millions]  0.292308  1.000000   
58                                     [Exploit]  0.292308  1.000000   
59                                    [Ethereum]  0.292308  0.487179   

    supp x conf      lift  
0      0.139860  0.953079  
1      0.024814  0.953079  
2      0.476923  1.048387  
3      0.238462  1.048387  
4      0.218859  1.024006  
5      0.157782  1.024006  
6      0.179156  0.948541  
7      0.132234  0.948541  
8      0.437717  1.024006  
9      0.631127  1.024006  
10     0.397022  0.998464  
11     0.586081  0.998464  
12     0.024814  0.953079  
13     0.139860  0.953079  
14     0.024814  1.048387  
15     0.153846  1.048387  
16     0.035732  1.048387  
17     0.184615  1.048387  
18     0.035732  1.048387  
19     0.184615  1.048387  
20     0.572451  1.439646  
21     0.586081  1.439646  
22     0.218859  1.048387  
23     0.109429  1.048387  
24     0.157782  1.024006  
25     0.218859  1.024006  
26     0.323077  1.048387  
27     0.161538  1.048387  
28     0.179156  0.995968  
29     0.089578  1.048387  
30     0.132234  0.948541  
31     0.179156  0.948541  
32     0.292308  1.048387  
33     0.138846  0.995968  
34     0.179156  0.995968  
35     0.129159  1.511628  
36     0.132234  1.400227  
37     0.264469  1.400227  
38     0.292308  1.511628  
39     0.138846  0.995968  
40     0.377419  1.022177  
41     0.544186  1.473837  
42     0.557143  1.437075  
43     0.557143  1.437075  
44     0.585000  1.473837  
45     0.585000  1.022177  
46     0.179156  1.021505  
47     0.089578  1.048387  
48     0.129159  1.511628  
49     0.132234  1.400227  
50     0.179156  0.995968  
51     0.264469  1.470238  
52     0.292308  1.547619  
53     0.132234  1.547619  
54     0.138846  1.470238  
55     0.138846  0.995968  
56     0.264469  1.400227  
57     0.292308  1.511628  
58     0.292308  1.048387  
59     0.142406  1.021505  
                                             rhs  \
0                                          [CEX]   
1                                      [Exploit]   
2                                     [Ethereum]   
3                                      [Exploit]   
4                                     [Ethereum]   
5                              [FL Low Millions]   
6                                     [Ethereum]   
7                              [FR Low Millions]   
8                                      [Exploit]   
9                              [FL Low Millions]   
10                                     [Exploit]   
11                             [FR Low Millions]   
12                                     [Exploit]   
13                                      [Friday]   
14                                     [Exploit]   
15                                    [Saturday]   
16                                     [Exploit]   
17                                      [Sunday]   
18                                     [Exploit]   
19                                     [Tuesday]   
20                             [FL Low Millions]   
21                             [FR Low Millions]   
22                                    [Ethereum]   
23                                     [Exploit]   
24                             [FL Low Millions]   
25                           [Exploit, Ethereum]   
26                   [Ethereum, FL Low Millions]   
27                    [Exploit, FL Low Millions]   
28                                    [Ethereum]   
29                                     [Exploit]   
30                             [FR Low Millions]   
31                           [Exploit, Ethereum]   
32                   [FR Low Millions, Ethereum]   
33                    [Exploit, FR Low Millions]   
34                                    [Ethereum]   
35                             [FL Low Millions]   
36                             [FR Low Millions]   
37                   [Ethereum, FL Low Millions]   
38                   [FR Low Millions, Ethereum]   
39            [FR Low Millions, FL Low Millions]   
40                                     [Exploit]   
41                             [FL Low Millions]   
42                             [FR Low Millions]   
43                    [Exploit, FL Low Millions]   
44                    [Exploit, FR Low Millions]   
45            [FR Low Millions, FL Low Millions]   
46                                    [Ethereum]   
47                                     [Exploit]   
48                             [FL Low Millions]   
49                             [FR Low Millions]   
50                           [Exploit, Ethereum]   
51                   [Ethereum, FL Low Millions]   
52                   [FR Low Millions, Ethereum]   
53                    [Exploit, FL Low Millions]   
54                    [Exploit, FR Low Millions]   
55            [FR Low Millions, FL Low Millions]   
56          [Exploit, Ethereum, FL Low Millions]   
57          [Exploit, Ethereum, FR Low Millions]   
58  [FR Low Millions, Ethereum, FL Low Millions]   
59   [Exploit, FL Low Millions, FR Low Millions]   

                                             lhs      supp      conf  \
0                                      [Exploit]  0.153846  0.909091   
1                                          [CEX]  0.153846  0.161290   
2                                      [Exploit]  0.476923  1.000000   
3                                     [Ethereum]  0.476923  0.500000   
4                              [FL Low Millions]  0.323077  0.677419   
5                                     [Ethereum]  0.323077  0.488372   
6                              [FR Low Millions]  0.292308  0.612903   
7                                     [Ethereum]  0.292308  0.452381   
8                              [FL Low Millions]  0.646154  0.677419   
9                                      [Exploit]  0.646154  0.976744   
10                             [FR Low Millions]  0.615385  0.645161   
11                                     [Exploit]  0.615385  0.952381   
12                                      [Friday]  0.153846  0.161290   
13                                     [Exploit]  0.153846  0.909091   
14                                    [Saturday]  0.153846  0.161290   
15                                     [Exploit]  0.153846  1.000000   
16                                      [Sunday]  0.184615  0.193548   
17                                     [Exploit]  0.184615  1.000000   
18                                     [Tuesday]  0.184615  0.193548   
19                                     [Exploit]  0.184615  1.000000   
20                             [FR Low Millions]  0.615385  0.930233   
21                             [FL Low Millions]  0.615385  0.952381   
22                    [Exploit, FL Low Millions]  0.323077  0.677419   
23                   [Ethereum, FL Low Millions]  0.323077  0.338710   
24                           [Exploit, Ethereum]  0.323077  0.488372   
25                             [FL Low Millions]  0.323077  0.677419   
26                                     [Exploit]  0.323077  1.000000   
27                                    [Ethereum]  0.323077  0.500000   
28                    [Exploit, FR Low Millions]  0.292308  0.612903   
29                   [FR Low Millions, Ethereum]  0.292308  0.306452   
30                           [Exploit, Ethereum]  0.292308  0.452381   
31                             [FR Low Millions]  0.292308  0.612903   
32                                     [Exploit]  0.292308  1.000000   
33                                    [Ethereum]  0.292308  0.475000   
34            [FR Low Millions, FL Low Millions]  0.292308  0.612903   
35                   [FR Low Millions, Ethereum]  0.292308  0.441860   
36                   [Ethereum, FL Low Millions]  0.292308  0.452381   
37                             [FR Low Millions]  0.292308  0.904762   
38                             [FL Low Millions]  0.292308  1.000000   
39                                    [Ethereum]  0.292308  0.475000   
40            [FR Low Millions, FL Low Millions]  0.600000  0.629032   
41                    [Exploit, FR Low Millions]  0.600000  0.906977   
42                    [Exploit, FL Low Millions]  0.600000  0.928571   
43                             [FR Low Millions]  0.600000  0.928571   
44                             [FL Low Millions]  0.600000  0.975000   
45                                     [Exploit]  0.600000  0.975000   
46   [Exploit, FL Low Millions, FR Low Millions]  0.292308  0.612903   
47  [FR Low Millions, Ethereum, FL Low Millions]  0.292308  0.306452   
48          [Exploit, Ethereum, FR Low Millions]  0.292308  0.441860   
49          [Exploit, Ethereum, FL Low Millions]  0.292308  0.452381   
50            [FR Low Millions, FL Low Millions]  0.292308  0.612903   
51                    [Exploit, FR Low Millions]  0.292308  0.904762   
52                    [Exploit, FL Low Millions]  0.292308  1.000000   
53                   [FR Low Millions, Ethereum]  0.292308  0.452381   
54                   [Ethereum, FL Low Millions]  0.292308  0.475000   
55                           [Exploit, Ethereum]  0.292308  0.475000   
56                             [FR Low Millions]  0.292308  0.904762   
57                             [FL Low Millions]  0.292308  1.000000   
58                                     [Exploit]  0.292308  1.000000   
59                                    [Ethereum]  0.292308  0.487179   

    supp x conf      lift  
0      0.139860  0.953079  
1      0.024814  0.953079  
2      0.476923  1.048387  
3      0.238462  1.048387  
4      0.218859  1.024006  
5      0.157782  1.024006  
6      0.179156  0.948541  
7      0.132234  0.948541  
8      0.437717  1.024006  
9      0.631127  1.024006  
10     0.397022  0.998464  
11     0.586081  0.998464  
12     0.024814  0.953079  
13     0.139860  0.953079  
14     0.024814  1.048387  
15     0.153846  1.048387  
16     0.035732  1.048387  
17     0.184615  1.048387  
18     0.035732  1.048387  
19     0.184615  1.048387  
20     0.572451  1.439646  
21     0.586081  1.439646  
22     0.218859  1.048387  
23     0.109429  1.048387  
24     0.157782  1.024006  
25     0.218859  1.024006  
26     0.323077  1.048387  
27     0.161538  1.048387  
28     0.179156  0.995968  
29     0.089578  1.048387  
30     0.132234  0.948541  
31     0.179156  0.948541  
32     0.292308  1.048387  
33     0.138846  0.995968  
34     0.179156  0.995968  
35     0.129159  1.511628  
36     0.132234  1.400227  
37     0.264469  1.400227  
38     0.292308  1.511628  
39     0.138846  0.995968  
40     0.377419  1.022177  
41     0.544186  1.473837  
42     0.557143  1.437075  
43     0.557143  1.437075  
44     0.585000  1.473837  
45     0.585000  1.022177  
46     0.179156  1.021505  
47     0.089578  1.048387  
48     0.129159  1.511628  
49     0.132234  1.400227  
50     0.179156  0.995968  
51     0.264469  1.470238  
52     0.292308  1.547619  
53     0.132234  1.547619  
54     0.138846  1.470238  
55     0.138846  0.995968  
56     0.264469  1.400227  
57     0.292308  1.511628  
58     0.292308  1.048387  
59     0.142406  1.021505  </code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="ARM_files/figure-html/cell-14-output-2.png" width="1135" height="1148"></p>
</div>
</div>
<p>From the above NetworkX graph obtained after filtering no funds returned values, a clear association between the Ethereum chain and funds lost as well as returned in the millions can be seen. Moreover, most of these attacks were Exploits, comprising Access Control, Flash Loan Attacks, and Phishing. If funds were lost between $1,000,000 and $500,000,0000 from the Ethereum chain due to Exploits, funds were returned too in the same magnitude as which they were lost. Moreover, weekends still trump weekdays when an attack took place.</p>
</section>
</section>
<section id="conclusions" class="level1">
<h1>Conclusions</h1>
<p>To wrap up, we found that attacks that were Exploits (Access Control, Flash Loan Attacks, and Phishing) were generally linked to the Ethereum chain and lost as well as recovered funds in the low millions (USD). The CEX cryptocurrency platform too was related to exploit attacks and were able to recover funds in the low millions (USD). Exit Scams comprising Honeypot attacks, Rugpull attacks, and Abandoned scams, on the other hand, were attacks that generally resulted in funds lost in the low millions (USD) but not being able to recover any funds. Exploit attacks were common on weekends rather than weekdays resulted in Our dataset was conducive to running the Apriori Algorithm on it; however, a larger dataset would take more time train on and may result in more insignificant rules to filter from.</p>
</section>
<section id="references" class="level1">
<h1>References</h1>
<p>“Association Rule Learning.” Wikipedia. Wikimedia Foundation. Accessed December 1, 2022. https://en.wikipedia.org/wiki/Association_rule_learning.</p>
<p>“Association Rules and the Apriori Algorithm: A Tutorial.” KDnuggets. Accessed December 1, 2022. https://www.kdnuggets.com/2016/04/association-rules-apriori-algorithm-tutorial.html.</p>
<!-- -->

</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb21" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co">    backgroundcolor: "#63666A"</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co">    fontcolor: white</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co">    linkcolor: black</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="co">    df-print: paged</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co">    highlight-style: vim-dark</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="an">jupyter:</span><span class="co"> python3</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="fu"># Association Rule Mining with Record Data (REKT Database)</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="fu">## Introduction</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>For ARM analysis, we shall use the cleaned REKT Database that we used for classification analysis. Like clustering analysis, ARM does not require a response variable beacuse it is an unsupervised machine learning method. However, unlike clustering, we do not drop the target variable (Y) of scam_type_grouped for ARM and treat it as a feature. Moreover, we will use the categorical variables month_of_attack and day_of_week_of_attack as two additional features. For simplicity, the day_of_year_of_attack variable shall be dropped because month_of_attack and day_of_week_of_attack convey enough information for datetime features. Additionally, because ARM requires all variables to be categorical, we shall convert the log funds (lost and returned) variables into their original dollar values and discretize them for accurate analysis.</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>The feature data (X) that we will eventually be left with will contain 6 record features, including two features of discretized funds (lost and returned), two datetime extracted features of month_of_attack and day_of_week_of_attack, and two categorical variables scamNetworks, which denotes the type of project or token associated with the attack, and scam_type_grouped, which denotes the type of attack (Exit Scam or Exploit). By the end of the analysis, we will showcase how these six variables relate with each other in terms of the rules generated by the Apriori Algorithm. We shall also make use of the support, confidence, and lift metrics to analyse the results of the network.</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a><span class="fu">## Theory</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Association Rule Mining (ARM) and the Apriori Algorithm</span></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>ARM is an unsupervised rule-based machine learning method that learns associations among item-sets or attributes. An item-set is a collection of attribute values that appears in one or more training examples. The rules take the form of "if-then" statements, including a precondition and conclusion. Format:</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>If precondition, Then conclusion (If A -&gt; Then B, where A and B is an item-set). We can also obtain the converse of a rule by swapping the precondition and conclusion. ARM's goal is to find rules (i.e. a model), given a set of transactions (training data), that will predict the occurrence of an item based on the occurrences of other items in the training data. To further understand how these rules are generated we must understand three metrics of a rule:</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Support: The popularity of an item set as measured by the proportion of transactions in which an item-set appears. Or, given a rule $A \Rightarrow B, Support(A, B) = P(A \cap B) = \frac{\text{number of transactions containing A and B}}{\text{total number of transactions}}$, where A and B are separate item sets that occur in at the same time in a transaction. Therefore, the support denotes how often items with A and items in B occur together relative to all other transactions. Support takes on values between 0 and 1, where 1 signifies that the item-set is highly important and 0 signifies irrelevance. For larger datasets, we prune the number of rules we shall consider by limiting ourselves with a sufficient support threshold. </span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Confidence: If the precondition holds true, how likely is it that the conclusion also holds? Therefore, $Confidence(A \Rightarrow B) = P(B|A) = \frac{support(A \cap B)}{support(A)} = \frac{\text{number of transactions containing A and B}}{\text{number of transactions containing A}}$. In words, confidence measures how often items in A and items in B occur together, relative to transactions that contain A. Confidence gauges how statistically “strong” a rule is and, like support, it takes on values between 0 and 1, where 1 indicates that B is bought everytime A is and 0 indicates no instance of the respective rule occuring.</span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Lift: How likely item B is present when item A is present, while controlling for how popular item B is. Therefore, $Lift(A \Rightarrow B) = \frac{support(A \cap B)}{support(A) * support(B)}$, given that A and B are independent. A lift value of 1 represents no associations between item-sets, so no rule can be drawn involving those item-sets. A lift value greater than 1 represents a positive relation between the items or, simply put, a dependence on one another. Whereas a lift value lesser than 1 represents negative relation between the items or a substitution effect between them.</span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>*It is also important to keep in mind that support does not change when we permute items in the item-set!*</span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>The Apriori Algorithm helps learn association rules and can be divided into 2 stages:</span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Gradually build up larger and larger item-sets that have sufficient support using a threshold</span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Form rules from item-sets by keeping those that have high enough confidence</span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a>Therefore, if we have n unique items, we obtain $2^n$ total number of item-sets and $3^n - 2^{n+1} + 1$ total possible association rules</span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a><span class="fu">## Methods</span></span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a><span class="fu">### Data Selection</span></span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a><span class="co"># import the necessary packages</span></span>
<span id="cb21-48"><a href="#cb21-48" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb21-49"><a href="#cb21-49" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb21-50"><a href="#cb21-50" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb21-51"><a href="#cb21-51" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb21-52"><a href="#cb21-52" aria-hidden="true" tabindex="-1"></a>sns.set_theme(style<span class="op">=</span><span class="st">"whitegrid"</span>, palette<span class="op">=</span><span class="st">'Set2'</span>)</span>
<span id="cb21-53"><a href="#cb21-53" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb21-54"><a href="#cb21-54" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">"ignore"</span>)</span>
<span id="cb21-55"><a href="#cb21-55" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> apyori <span class="im">import</span> apriori</span>
<span id="cb21-56"><a href="#cb21-56" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> networkx <span class="im">as</span> nx </span>
<span id="cb21-57"><a href="#cb21-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-58"><a href="#cb21-58" aria-hidden="true" tabindex="-1"></a><span class="co"># read in cleaned REKT Database and drop labels and other variables, leaving only feature data (X)</span></span>
<span id="cb21-59"><a href="#cb21-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-60"><a href="#cb21-60" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">"../../data/Clean Data/REKT_Database_Clean_Classification.csv"</span>, index_col<span class="op">=</span>[<span class="dv">0</span>])</span>
<span id="cb21-61"><a href="#cb21-61" aria-hidden="true" tabindex="-1"></a>df_arm <span class="op">=</span> df.drop([<span class="st">'day_of_year_of_attack'</span>], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb21-62"><a href="#cb21-62" aria-hidden="true" tabindex="-1"></a>df_arm.head() <span class="co"># visualize first 5 rows</span></span>
<span id="cb21-63"><a href="#cb21-63" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-64"><a href="#cb21-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-67"><a href="#cb21-67" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb21-68"><a href="#cb21-68" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'day_of_week_of_attack'</span>].value_counts()</span>
<span id="cb21-69"><a href="#cb21-69" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-70"><a href="#cb21-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-73"><a href="#cb21-73" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb21-74"><a href="#cb21-74" aria-hidden="true" tabindex="-1"></a>df_arm.shape <span class="co"># get the number of rows and columns</span></span>
<span id="cb21-75"><a href="#cb21-75" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-76"><a href="#cb21-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-79"><a href="#cb21-79" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb21-80"><a href="#cb21-80" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_arm.info()) <span class="co"># get column information</span></span>
<span id="cb21-81"><a href="#cb21-81" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-82"><a href="#cb21-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-85"><a href="#cb21-85" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb21-86"><a href="#cb21-86" aria-hidden="true" tabindex="-1"></a>df_arm.isnull().<span class="bu">sum</span>() <span class="co"># check for missing values</span></span>
<span id="cb21-87"><a href="#cb21-87" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-88"><a href="#cb21-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-89"><a href="#cb21-89" aria-hidden="true" tabindex="-1"></a><span class="fu">### Feature selection and Pre-processing</span></span>
<span id="cb21-90"><a href="#cb21-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-91"><a href="#cb21-91" aria-hidden="true" tabindex="-1"></a>We will first convert the log funds and log returned variables into their original values using numpy's exponential function. To convert the funds variables into categorical, we shall discretize them into the following values: "Billions $\Rightarrow$ funds $\geq$ 1,000,000,000", "High Millions $\Rightarrow$ 1000000000 $\leq$ funds $\geq$ 500000000", "Low Millions $\Rightarrow$ 500000000 $\leq$ funds $\geq$ 1000000", "High 100K's $\Rightarrow$ 1000000 $\leq$ funds $\geq$ 500000", "Low 100K's $\Rightarrow$ 500000 $\leq$ funds $\geq$ 100000", "Less Than 100K $\Rightarrow$ 100000 $\leq$ funds". Also, for the funds returned variable, because around 90% of values contain $0 being returned for an attack, we will add a "No Funds Returned" category.</span>
<span id="cb21-92"><a href="#cb21-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-93"><a href="#cb21-93" aria-hidden="true" tabindex="-1"></a>We shall also add names of months and days for the respective date time features, instead of keeping the numeric categories, for easier interpretation of the network. Lastly, we shall drop the log funds and original funds variables to keep only the discretized string variables for funds lost and funds returned.</span>
<span id="cb21-94"><a href="#cb21-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-97"><a href="#cb21-97" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb21-98"><a href="#cb21-98" aria-hidden="true" tabindex="-1"></a>df_arm[<span class="st">'funds_lost_USD'</span>] <span class="op">=</span> np.exp(df_arm[<span class="st">'log_funds_lost'</span>]).<span class="bu">round</span>()</span>
<span id="cb21-99"><a href="#cb21-99" aria-hidden="true" tabindex="-1"></a>df_arm[<span class="st">'funds_returned_USD'</span>] <span class="op">=</span> np.exp(df_arm[<span class="st">'log_funds_returned'</span>]).<span class="bu">round</span>() <span class="op">-</span> <span class="dv">1</span> <span class="co"># subtract 1 because we had zeros in funds_returned that avoided negative inf values when converting to log</span></span>
<span id="cb21-100"><a href="#cb21-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-101"><a href="#cb21-101" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> assign_funds_lost_val(row):</span>
<span id="cb21-102"><a href="#cb21-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-103"><a href="#cb21-103" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> row <span class="op">&gt;=</span> <span class="dv">1000000000</span>:</span>
<span id="cb21-104"><a href="#cb21-104" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">'FL Billions'</span></span>
<span id="cb21-105"><a href="#cb21-105" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> row <span class="op">&gt;=</span> <span class="dv">500000000</span> <span class="kw">and</span> row <span class="op">&lt;</span> <span class="dv">1000000000</span>:</span>
<span id="cb21-106"><a href="#cb21-106" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">'FL High Millions'</span></span>
<span id="cb21-107"><a href="#cb21-107" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> row <span class="op">&gt;=</span> <span class="dv">1000000</span> <span class="kw">and</span> row <span class="op">&lt;</span> <span class="dv">500000000</span>:</span>
<span id="cb21-108"><a href="#cb21-108" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">'FL Low Millions'</span></span>
<span id="cb21-109"><a href="#cb21-109" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> row <span class="op">&gt;=</span> <span class="dv">500000</span> <span class="kw">and</span> row <span class="op">&lt;</span> <span class="dv">1000000</span>:</span>
<span id="cb21-110"><a href="#cb21-110" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">"FL High 100K's"</span></span>
<span id="cb21-111"><a href="#cb21-111" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> row <span class="op">&gt;=</span> <span class="dv">100000</span> <span class="kw">and</span> row <span class="op">&lt;</span> <span class="dv">500000</span>:</span>
<span id="cb21-112"><a href="#cb21-112" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">"FL Low 100K's"</span></span>
<span id="cb21-113"><a href="#cb21-113" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb21-114"><a href="#cb21-114" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">"FL Less Than 100K"</span></span>
<span id="cb21-115"><a href="#cb21-115" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result</span>
<span id="cb21-116"><a href="#cb21-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-117"><a href="#cb21-117" aria-hidden="true" tabindex="-1"></a>df_arm[<span class="st">'funds_lost_USD_discretized'</span>] <span class="op">=</span> df_arm[<span class="st">'funds_lost_USD'</span>].<span class="bu">apply</span>(assign_funds_lost_val)</span>
<span id="cb21-118"><a href="#cb21-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-119"><a href="#cb21-119" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> assign_funds_ret_val(row):</span>
<span id="cb21-120"><a href="#cb21-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-121"><a href="#cb21-121" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> row <span class="op">&gt;=</span> <span class="dv">1000000000</span>:</span>
<span id="cb21-122"><a href="#cb21-122" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">'FR Billions'</span></span>
<span id="cb21-123"><a href="#cb21-123" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> row <span class="op">&gt;=</span> <span class="dv">500000000</span> <span class="kw">and</span> row <span class="op">&lt;</span> <span class="dv">1000000000</span>:</span>
<span id="cb21-124"><a href="#cb21-124" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">'FR High Millions'</span></span>
<span id="cb21-125"><a href="#cb21-125" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> row <span class="op">&gt;=</span> <span class="dv">1000000</span> <span class="kw">and</span> row <span class="op">&lt;</span> <span class="dv">500000000</span>:</span>
<span id="cb21-126"><a href="#cb21-126" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">'FR Low Millions'</span></span>
<span id="cb21-127"><a href="#cb21-127" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> row <span class="op">&gt;=</span> <span class="dv">500000</span> <span class="kw">and</span> row <span class="op">&lt;</span> <span class="dv">1000000</span>:</span>
<span id="cb21-128"><a href="#cb21-128" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">"FR High 100K's"</span></span>
<span id="cb21-129"><a href="#cb21-129" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> row <span class="op">&gt;=</span> <span class="dv">100000</span> <span class="kw">and</span> row <span class="op">&lt;</span> <span class="dv">500000</span>:</span>
<span id="cb21-130"><a href="#cb21-130" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">"FR Low 100K's"</span></span>
<span id="cb21-131"><a href="#cb21-131" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> row <span class="op">&gt;</span> <span class="dv">0</span> <span class="kw">and</span> row <span class="op">&lt;</span> <span class="dv">100000</span>:</span>
<span id="cb21-132"><a href="#cb21-132" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">"FR Less Than 100K (&gt;0)"</span></span>
<span id="cb21-133"><a href="#cb21-133" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb21-134"><a href="#cb21-134" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">"No Funds Returned"</span></span>
<span id="cb21-135"><a href="#cb21-135" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result</span>
<span id="cb21-136"><a href="#cb21-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-137"><a href="#cb21-137" aria-hidden="true" tabindex="-1"></a>df_arm[<span class="st">'funds_returned_USD_discretized'</span>] <span class="op">=</span> df_arm[<span class="st">'funds_returned_USD'</span>].<span class="bu">apply</span>(assign_funds_ret_val)</span>
<span id="cb21-138"><a href="#cb21-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-139"><a href="#cb21-139" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> assign_month(row):</span>
<span id="cb21-140"><a href="#cb21-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-141"><a href="#cb21-141" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> row <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb21-142"><a href="#cb21-142" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">'January'</span></span>
<span id="cb21-143"><a href="#cb21-143" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> row <span class="op">==</span> <span class="dv">2</span>:</span>
<span id="cb21-144"><a href="#cb21-144" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">'February'</span></span>
<span id="cb21-145"><a href="#cb21-145" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> row <span class="op">==</span> <span class="dv">3</span>:</span>
<span id="cb21-146"><a href="#cb21-146" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">'March'</span></span>
<span id="cb21-147"><a href="#cb21-147" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> row <span class="op">==</span> <span class="dv">4</span>:</span>
<span id="cb21-148"><a href="#cb21-148" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">"April"</span></span>
<span id="cb21-149"><a href="#cb21-149" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> row <span class="op">==</span> <span class="dv">5</span>:</span>
<span id="cb21-150"><a href="#cb21-150" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">"May"</span></span>
<span id="cb21-151"><a href="#cb21-151" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> row <span class="op">==</span> <span class="dv">6</span>:</span>
<span id="cb21-152"><a href="#cb21-152" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">"June"</span></span>
<span id="cb21-153"><a href="#cb21-153" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> row <span class="op">==</span> <span class="dv">7</span>:</span>
<span id="cb21-154"><a href="#cb21-154" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">"July"</span></span>
<span id="cb21-155"><a href="#cb21-155" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> row <span class="op">==</span> <span class="dv">8</span>:</span>
<span id="cb21-156"><a href="#cb21-156" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">"August"</span></span>
<span id="cb21-157"><a href="#cb21-157" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> row <span class="op">==</span> <span class="dv">9</span>:</span>
<span id="cb21-158"><a href="#cb21-158" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">"September"</span></span>
<span id="cb21-159"><a href="#cb21-159" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> row <span class="op">==</span> <span class="dv">10</span>:</span>
<span id="cb21-160"><a href="#cb21-160" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">"October"</span></span>
<span id="cb21-161"><a href="#cb21-161" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> row <span class="op">==</span> <span class="dv">11</span>:</span>
<span id="cb21-162"><a href="#cb21-162" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">"October"</span></span>
<span id="cb21-163"><a href="#cb21-163" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb21-164"><a href="#cb21-164" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">"December"</span></span>
<span id="cb21-165"><a href="#cb21-165" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result</span>
<span id="cb21-166"><a href="#cb21-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-167"><a href="#cb21-167" aria-hidden="true" tabindex="-1"></a>df_arm[<span class="st">'month_of_attack'</span>] <span class="op">=</span> df_arm[<span class="st">'month_of_attack'</span>].<span class="bu">apply</span>(assign_month)</span>
<span id="cb21-168"><a href="#cb21-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-169"><a href="#cb21-169" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> assign_dow(row):</span>
<span id="cb21-170"><a href="#cb21-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-171"><a href="#cb21-171" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> row <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb21-172"><a href="#cb21-172" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">'Monday'</span></span>
<span id="cb21-173"><a href="#cb21-173" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> row <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb21-174"><a href="#cb21-174" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">'Tuesday'</span></span>
<span id="cb21-175"><a href="#cb21-175" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> row <span class="op">==</span> <span class="dv">2</span>:</span>
<span id="cb21-176"><a href="#cb21-176" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">'Wednesday'</span></span>
<span id="cb21-177"><a href="#cb21-177" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> row <span class="op">==</span> <span class="dv">3</span>:</span>
<span id="cb21-178"><a href="#cb21-178" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">"Thursday"</span></span>
<span id="cb21-179"><a href="#cb21-179" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> row <span class="op">==</span> <span class="dv">4</span>:</span>
<span id="cb21-180"><a href="#cb21-180" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">"Friday"</span></span>
<span id="cb21-181"><a href="#cb21-181" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> row <span class="op">==</span> <span class="dv">5</span>:</span>
<span id="cb21-182"><a href="#cb21-182" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">"Saturday"</span></span>
<span id="cb21-183"><a href="#cb21-183" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb21-184"><a href="#cb21-184" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="st">"Sunday"</span></span>
<span id="cb21-185"><a href="#cb21-185" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result</span>
<span id="cb21-186"><a href="#cb21-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-187"><a href="#cb21-187" aria-hidden="true" tabindex="-1"></a>df_arm[<span class="st">'day_of_week_of_attack'</span>] <span class="op">=</span> df_arm[<span class="st">'day_of_week_of_attack'</span>].<span class="bu">apply</span>(assign_dow)</span>
<span id="cb21-188"><a href="#cb21-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-189"><a href="#cb21-189" aria-hidden="true" tabindex="-1"></a>df_arm <span class="op">=</span> df_arm.drop([<span class="st">'log_funds_lost'</span>, <span class="st">'log_funds_returned'</span>, <span class="st">'funds_lost_USD'</span>, <span class="st">'funds_returned_USD'</span>], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb21-190"><a href="#cb21-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-191"><a href="#cb21-191" aria-hidden="true" tabindex="-1"></a>df_arm.head()</span>
<span id="cb21-192"><a href="#cb21-192" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-193"><a href="#cb21-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-196"><a href="#cb21-196" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb21-197"><a href="#cb21-197" aria-hidden="true" tabindex="-1"></a>df_arm[<span class="st">'funds_returned_USD_discretized'</span>].value_counts()</span>
<span id="cb21-198"><a href="#cb21-198" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-199"><a href="#cb21-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-200"><a href="#cb21-200" aria-hidden="true" tabindex="-1"></a>The above table shows us the frequency of each discretized numeric value for funds returned (USD). Almost 90% of attacks did not result in funds being returned to the respective cyryptocurrency project or chain. Keeping this factor in mind, we shall create 2 Apriori Algorithm models, one with with no funds returned and one without.</span>
<span id="cb21-201"><a href="#cb21-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-204"><a href="#cb21-204" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb21-205"><a href="#cb21-205" aria-hidden="true" tabindex="-1"></a><span class="co"># CONVERT THE DATA FRAME TO A LIST OF LISTS</span></span>
<span id="cb21-206"><a href="#cb21-206" aria-hidden="true" tabindex="-1"></a>transactions <span class="op">=</span> []</span>
<span id="cb21-207"><a href="#cb21-207" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, df_arm.shape[<span class="dv">0</span>]):</span>
<span id="cb21-208"><a href="#cb21-208" aria-hidden="true" tabindex="-1"></a>    transaction<span class="op">=</span>[]</span>
<span id="cb21-209"><a href="#cb21-209" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, df_arm.shape[<span class="dv">1</span>]):</span>
<span id="cb21-210"><a href="#cb21-210" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(<span class="bu">str</span>(df_arm.iloc[i,j]) <span class="op">!=</span> <span class="st">"nan"</span>):</span>
<span id="cb21-211"><a href="#cb21-211" aria-hidden="true" tabindex="-1"></a>            transaction.append(df_arm.iloc[i,j])</span>
<span id="cb21-212"><a href="#cb21-212" aria-hidden="true" tabindex="-1"></a>    transactions.append(transaction)</span>
<span id="cb21-213"><a href="#cb21-213" aria-hidden="true" tabindex="-1"></a><span class="co">#print(transactions)</span></span>
<span id="cb21-214"><a href="#cb21-214" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-215"><a href="#cb21-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-216"><a href="#cb21-216" aria-hidden="true" tabindex="-1"></a><span class="fu"># Utility function: Re-format output</span></span>
<span id="cb21-217"><a href="#cb21-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-220"><a href="#cb21-220" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb21-221"><a href="#cb21-221" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> apyori <span class="im">import</span> apriori</span>
<span id="cb21-222"><a href="#cb21-222" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd </span>
<span id="cb21-223"><a href="#cb21-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-224"><a href="#cb21-224" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reformat_results(results):</span>
<span id="cb21-225"><a href="#cb21-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-226"><a href="#cb21-226" aria-hidden="true" tabindex="-1"></a>    <span class="co">#CLEAN-UP RESULTS </span></span>
<span id="cb21-227"><a href="#cb21-227" aria-hidden="true" tabindex="-1"></a>    keep<span class="op">=</span>[]</span>
<span id="cb21-228"><a href="#cb21-228" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>,<span class="bu">len</span>(results)):</span>
<span id="cb21-229"><a href="#cb21-229" aria-hidden="true" tabindex="-1"></a>        <span class="co"># print("=====================================")</span></span>
<span id="cb21-230"><a href="#cb21-230" aria-hidden="true" tabindex="-1"></a>        <span class="co"># print(results[i])</span></span>
<span id="cb21-231"><a href="#cb21-231" aria-hidden="true" tabindex="-1"></a>        <span class="co"># print(len(list(results[i])))</span></span>
<span id="cb21-232"><a href="#cb21-232" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>,<span class="bu">len</span>(<span class="bu">list</span>(results[i]))):</span>
<span id="cb21-233"><a href="#cb21-233" aria-hidden="true" tabindex="-1"></a>            <span class="co"># print(results)</span></span>
<span id="cb21-234"><a href="#cb21-234" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span>(j<span class="op">&gt;</span><span class="dv">1</span>):</span>
<span id="cb21-235"><a href="#cb21-235" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>,<span class="bu">len</span>(<span class="bu">list</span>(results[i][j]))):</span>
<span id="cb21-236"><a href="#cb21-236" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span>(<span class="bu">len</span>(results[i][j][k][<span class="dv">0</span>])<span class="op">!=</span><span class="dv">0</span>):</span>
<span id="cb21-237"><a href="#cb21-237" aria-hidden="true" tabindex="-1"></a>                        <span class="co">#print(len(results[i][j][k][0]),results[i][j][k][0])</span></span>
<span id="cb21-238"><a href="#cb21-238" aria-hidden="true" tabindex="-1"></a>                        rhs<span class="op">=</span><span class="bu">list</span>(results[i][j][k][<span class="dv">0</span>])</span>
<span id="cb21-239"><a href="#cb21-239" aria-hidden="true" tabindex="-1"></a>                        lhs<span class="op">=</span><span class="bu">list</span>(results[i][j][k][<span class="dv">1</span>])</span>
<span id="cb21-240"><a href="#cb21-240" aria-hidden="true" tabindex="-1"></a>                        conf<span class="op">=</span><span class="bu">float</span>(results[i][j][k][<span class="dv">2</span>])</span>
<span id="cb21-241"><a href="#cb21-241" aria-hidden="true" tabindex="-1"></a>                        lift<span class="op">=</span><span class="bu">float</span>(results[i][j][k][<span class="dv">3</span>])</span>
<span id="cb21-242"><a href="#cb21-242" aria-hidden="true" tabindex="-1"></a>                        keep.append([rhs,lhs,supp,conf,supp<span class="op">*</span>conf,lift])</span>
<span id="cb21-243"><a href="#cb21-243" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># keep.append()</span></span>
<span id="cb21-244"><a href="#cb21-244" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span>(j<span class="op">==</span><span class="dv">1</span>):</span>
<span id="cb21-245"><a href="#cb21-245" aria-hidden="true" tabindex="-1"></a>                supp<span class="op">=</span>results[i][j]</span>
<span id="cb21-246"><a href="#cb21-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-247"><a href="#cb21-247" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pd.DataFrame(keep, columns <span class="op">=</span>[<span class="st">"rhs"</span>,<span class="st">"lhs"</span>,<span class="st">"supp"</span>,<span class="st">"conf"</span>,<span class="st">"supp x conf"</span>,<span class="st">"lift"</span>])</span>
<span id="cb21-248"><a href="#cb21-248" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-249"><a href="#cb21-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-250"><a href="#cb21-250" aria-hidden="true" tabindex="-1"></a><span class="fu"># Utility function: Convert to NetworkX object </span></span>
<span id="cb21-251"><a href="#cb21-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-254"><a href="#cb21-254" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb21-255"><a href="#cb21-255" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_to_network(df):</span>
<span id="cb21-256"><a href="#cb21-256" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(df)</span>
<span id="cb21-257"><a href="#cb21-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-258"><a href="#cb21-258" aria-hidden="true" tabindex="-1"></a>    <span class="co">#BUILD GRAPH</span></span>
<span id="cb21-259"><a href="#cb21-259" aria-hidden="true" tabindex="-1"></a>    G <span class="op">=</span> nx.DiGraph()  <span class="co"># DIRECTED</span></span>
<span id="cb21-260"><a href="#cb21-260" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> row <span class="kw">in</span> df.iterrows():</span>
<span id="cb21-261"><a href="#cb21-261" aria-hidden="true" tabindex="-1"></a>        <span class="co"># for column in df.columns:</span></span>
<span id="cb21-262"><a href="#cb21-262" aria-hidden="true" tabindex="-1"></a>        lhs<span class="op">=</span><span class="st">"_"</span>.join(row[<span class="dv">1</span>][<span class="dv">0</span>])</span>
<span id="cb21-263"><a href="#cb21-263" aria-hidden="true" tabindex="-1"></a>        rhs<span class="op">=</span><span class="st">"_"</span>.join(row[<span class="dv">1</span>][<span class="dv">1</span>])</span>
<span id="cb21-264"><a href="#cb21-264" aria-hidden="true" tabindex="-1"></a>        conf<span class="op">=</span>row[<span class="dv">1</span>][<span class="dv">3</span>]<span class="op">;</span> <span class="co">#print(conf)</span></span>
<span id="cb21-265"><a href="#cb21-265" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(lhs <span class="kw">not</span> <span class="kw">in</span> G.nodes): </span>
<span id="cb21-266"><a href="#cb21-266" aria-hidden="true" tabindex="-1"></a>            G.add_node(lhs)</span>
<span id="cb21-267"><a href="#cb21-267" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(rhs <span class="kw">not</span> <span class="kw">in</span> G.nodes): </span>
<span id="cb21-268"><a href="#cb21-268" aria-hidden="true" tabindex="-1"></a>            G.add_node(rhs)</span>
<span id="cb21-269"><a href="#cb21-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-270"><a href="#cb21-270" aria-hidden="true" tabindex="-1"></a>        edge<span class="op">=</span>(lhs,rhs)</span>
<span id="cb21-271"><a href="#cb21-271" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> edge <span class="kw">not</span> <span class="kw">in</span> G.edges:</span>
<span id="cb21-272"><a href="#cb21-272" aria-hidden="true" tabindex="-1"></a>            G.add_edge(lhs, rhs, weight<span class="op">=</span>conf)</span>
<span id="cb21-273"><a href="#cb21-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-274"><a href="#cb21-274" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print(G.nodes)</span></span>
<span id="cb21-275"><a href="#cb21-275" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print(G.edges)</span></span>
<span id="cb21-276"><a href="#cb21-276" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> G</span>
<span id="cb21-277"><a href="#cb21-277" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-278"><a href="#cb21-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-279"><a href="#cb21-279" aria-hidden="true" tabindex="-1"></a><span class="fu"># Utility function: Plot NetworkX object</span></span>
<span id="cb21-280"><a href="#cb21-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-283"><a href="#cb21-283" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb21-284"><a href="#cb21-284" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_network(G):</span>
<span id="cb21-285"><a href="#cb21-285" aria-hidden="true" tabindex="-1"></a>    <span class="co">#SPECIFIY X-Y POSITIONS FOR PLOTTING</span></span>
<span id="cb21-286"><a href="#cb21-286" aria-hidden="true" tabindex="-1"></a>    pos<span class="op">=</span>nx.random_layout(G)</span>
<span id="cb21-287"><a href="#cb21-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-288"><a href="#cb21-288" aria-hidden="true" tabindex="-1"></a>    <span class="co">#GENERATE PLOT</span></span>
<span id="cb21-289"><a href="#cb21-289" aria-hidden="true" tabindex="-1"></a>    fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb21-290"><a href="#cb21-290" aria-hidden="true" tabindex="-1"></a>    fig.set_size_inches(<span class="dv">15</span>, <span class="dv">15</span>)</span>
<span id="cb21-291"><a href="#cb21-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-292"><a href="#cb21-292" aria-hidden="true" tabindex="-1"></a>    <span class="co">#assign colors based on attributes</span></span>
<span id="cb21-293"><a href="#cb21-293" aria-hidden="true" tabindex="-1"></a>    weights_e   <span class="op">=</span> [G[u][v][<span class="st">'weight'</span>] <span class="cf">for</span> u,v <span class="kw">in</span> G.edges()]</span>
<span id="cb21-294"><a href="#cb21-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-295"><a href="#cb21-295" aria-hidden="true" tabindex="-1"></a>    <span class="co">#SAMPLE CMAP FOR COLORS </span></span>
<span id="cb21-296"><a href="#cb21-296" aria-hidden="true" tabindex="-1"></a>    cmap<span class="op">=</span>plt.cm.get_cmap(<span class="st">'Blues'</span>)</span>
<span id="cb21-297"><a href="#cb21-297" aria-hidden="true" tabindex="-1"></a>    colors_e    <span class="op">=</span> [cmap(G[u][v][<span class="st">'weight'</span>]<span class="op">/</span><span class="fl">5.0</span>) <span class="cf">for</span> u,v <span class="kw">in</span> G.edges()]</span>
<span id="cb21-298"><a href="#cb21-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-299"><a href="#cb21-299" aria-hidden="true" tabindex="-1"></a>    <span class="co">#PLOT</span></span>
<span id="cb21-300"><a href="#cb21-300" aria-hidden="true" tabindex="-1"></a>    nx.draw(</span>
<span id="cb21-301"><a href="#cb21-301" aria-hidden="true" tabindex="-1"></a>    G,</span>
<span id="cb21-302"><a href="#cb21-302" aria-hidden="true" tabindex="-1"></a>    edgecolors<span class="op">=</span><span class="st">"black"</span>,</span>
<span id="cb21-303"><a href="#cb21-303" aria-hidden="true" tabindex="-1"></a>    edge_color<span class="op">=</span>colors_e,</span>
<span id="cb21-304"><a href="#cb21-304" aria-hidden="true" tabindex="-1"></a>    node_size<span class="op">=</span><span class="dv">3000</span>,</span>
<span id="cb21-305"><a href="#cb21-305" aria-hidden="true" tabindex="-1"></a>    linewidths<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb21-306"><a href="#cb21-306" aria-hidden="true" tabindex="-1"></a>    font_size<span class="op">=</span><span class="dv">8</span>,</span>
<span id="cb21-307"><a href="#cb21-307" aria-hidden="true" tabindex="-1"></a>    font_color<span class="op">=</span><span class="st">"red"</span>,</span>
<span id="cb21-308"><a href="#cb21-308" aria-hidden="true" tabindex="-1"></a>    font_weight<span class="op">=</span><span class="st">"bold"</span>,</span>
<span id="cb21-309"><a href="#cb21-309" aria-hidden="true" tabindex="-1"></a>    width<span class="op">=</span>weights_e,</span>
<span id="cb21-310"><a href="#cb21-310" aria-hidden="true" tabindex="-1"></a>    with_labels<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb21-311"><a href="#cb21-311" aria-hidden="true" tabindex="-1"></a>    pos<span class="op">=</span>pos,</span>
<span id="cb21-312"><a href="#cb21-312" aria-hidden="true" tabindex="-1"></a>    ax<span class="op">=</span>ax</span>
<span id="cb21-313"><a href="#cb21-313" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb21-314"><a href="#cb21-314" aria-hidden="true" tabindex="-1"></a>    nx.spring_layout(G, <span class="dv">1</span><span class="op">/</span><span class="dv">5</span>)</span>
<span id="cb21-315"><a href="#cb21-315" aria-hidden="true" tabindex="-1"></a>    ax.<span class="bu">set</span>(title<span class="op">=</span><span class="st">'REKT Database ARM Network Graph'</span>)</span>
<span id="cb21-316"><a href="#cb21-316" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ax.set_aspect('equal', 'box')</span></span>
<span id="cb21-317"><a href="#cb21-317" aria-hidden="true" tabindex="-1"></a>    <span class="co"># plt.colorbar(cmap)</span></span>
<span id="cb21-318"><a href="#cb21-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-319"><a href="#cb21-319" aria-hidden="true" tabindex="-1"></a>    <span class="co"># fig.savefig("test.png")</span></span>
<span id="cb21-320"><a href="#cb21-320" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb21-321"><a href="#cb21-321" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-322"><a href="#cb21-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-323"><a href="#cb21-323" aria-hidden="true" tabindex="-1"></a><span class="fu"># Perform Apriori Algorithm</span></span>
<span id="cb21-324"><a href="#cb21-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-327"><a href="#cb21-327" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb21-328"><a href="#cb21-328" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Transactions:"</span>,pd.DataFrame(transactions))</span>
<span id="cb21-329"><a href="#cb21-329" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> <span class="bu">list</span>(apriori(transactions, min_support<span class="op">=</span><span class="fl">0.15</span>, min_confidence<span class="op">=</span><span class="fl">0.2</span>, min_length<span class="op">=</span><span class="dv">2</span>, max_length<span class="op">=</span><span class="dv">10</span>))     <span class="co">#RUN APRIORI ALGORITHM</span></span>
<span id="cb21-330"><a href="#cb21-330" aria-hidden="true" tabindex="-1"></a>pd_results<span class="op">=</span>reformat_results(results)</span>
<span id="cb21-331"><a href="#cb21-331" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Results</span><span class="ch">\n</span><span class="st">"</span>,pd_results)</span>
<span id="cb21-332"><a href="#cb21-332" aria-hidden="true" tabindex="-1"></a>G<span class="op">=</span>convert_to_network(pd_results)</span>
<span id="cb21-333"><a href="#cb21-333" aria-hidden="true" tabindex="-1"></a>plot_network(G)</span>
<span id="cb21-334"><a href="#cb21-334" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-335"><a href="#cb21-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-336"><a href="#cb21-336" aria-hidden="true" tabindex="-1"></a>According to the above NetworkX graph and table of metrics, we see that a lot of rules, with lift &gt; 1, were formed for no funds returned (USD). I also chose a minimum confidence threshold of 0.2 to include date time features in the graph. A confidence threshold of higher than that eliminates the date time features, which means that rules including date time item-sets get pruned due to their low associations with funds lost and returned. The graph provides insights about the Ethereum and Binance cryptocurrency platforms losing funds in the low 100 thousand's ($100,000 to $500,000) and low millions ($1,000,000 to $500,000,000) that led to no funds being returned. Because no funds returned is a majority category of the data (almost 90%), we obtained these rules that were dominated with no funds returned. </span>
<span id="cb21-337"><a href="#cb21-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-338"><a href="#cb21-338" aria-hidden="true" tabindex="-1"></a>In terms of the datetime features, weekends are more likely to be associated with attacks than weekdays are. Let's see what other insights can be generated if we filter out values where no funds were returned...</span>
<span id="cb21-339"><a href="#cb21-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-340"><a href="#cb21-340" aria-hidden="true" tabindex="-1"></a><span class="fu">### Apriori Algorithm After Filtering No Funds Returned Values</span></span>
<span id="cb21-341"><a href="#cb21-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-344"><a href="#cb21-344" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb21-345"><a href="#cb21-345" aria-hidden="true" tabindex="-1"></a>df_arm_flitered <span class="op">=</span> df_arm.query(<span class="st">"funds_returned_USD_discretized != 'No Funds Returned'"</span>)</span>
<span id="cb21-346"><a href="#cb21-346" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_arm_flitered.shape)</span>
<span id="cb21-347"><a href="#cb21-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-348"><a href="#cb21-348" aria-hidden="true" tabindex="-1"></a><span class="co"># CONVERT THE DATA FRAME TO A LIST OF LISTS</span></span>
<span id="cb21-349"><a href="#cb21-349" aria-hidden="true" tabindex="-1"></a>transactions <span class="op">=</span> []</span>
<span id="cb21-350"><a href="#cb21-350" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, df_arm_flitered.shape[<span class="dv">0</span>]):</span>
<span id="cb21-351"><a href="#cb21-351" aria-hidden="true" tabindex="-1"></a>    transaction<span class="op">=</span>[]</span>
<span id="cb21-352"><a href="#cb21-352" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, df_arm_flitered.shape[<span class="dv">1</span>]):</span>
<span id="cb21-353"><a href="#cb21-353" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(<span class="bu">str</span>(df_arm_flitered.iloc[i,j]) <span class="op">!=</span> <span class="st">"nan"</span>):</span>
<span id="cb21-354"><a href="#cb21-354" aria-hidden="true" tabindex="-1"></a>            transaction.append(df_arm_flitered.iloc[i,j])</span>
<span id="cb21-355"><a href="#cb21-355" aria-hidden="true" tabindex="-1"></a>    transactions.append(transaction)</span>
<span id="cb21-356"><a href="#cb21-356" aria-hidden="true" tabindex="-1"></a><span class="co">#print(transactions)</span></span>
<span id="cb21-357"><a href="#cb21-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-358"><a href="#cb21-358" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Transactions:"</span>,pd.DataFrame(transactions))</span>
<span id="cb21-359"><a href="#cb21-359" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> <span class="bu">list</span>(apriori(transactions, min_support<span class="op">=</span><span class="fl">0.15</span>, min_confidence<span class="op">=</span><span class="fl">0.1</span>, min_length<span class="op">=</span><span class="dv">2</span>, max_length<span class="op">=</span><span class="dv">5</span>))     <span class="co">#RUN APRIORI ALGORITHM</span></span>
<span id="cb21-360"><a href="#cb21-360" aria-hidden="true" tabindex="-1"></a>pd_results<span class="op">=</span>reformat_results(results)</span>
<span id="cb21-361"><a href="#cb21-361" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Results</span><span class="ch">\n</span><span class="st">"</span>,pd_results)</span>
<span id="cb21-362"><a href="#cb21-362" aria-hidden="true" tabindex="-1"></a>G<span class="op">=</span>convert_to_network(pd_results)</span>
<span id="cb21-363"><a href="#cb21-363" aria-hidden="true" tabindex="-1"></a>plot_network(G)</span>
<span id="cb21-364"><a href="#cb21-364" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-365"><a href="#cb21-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-366"><a href="#cb21-366" aria-hidden="true" tabindex="-1"></a>From the above NetworkX graph obtained after filtering no funds returned values, a clear association between the Ethereum chain and funds lost as well as returned in the millions can be seen. Moreover, most of these attacks were Exploits, comprising Access Control, Flash Loan Attacks, and Phishing. If funds were lost between $1,000,000 and $500,000,0000 from the Ethereum chain due to Exploits, funds were returned too in the same magnitude as which they were lost. Moreover, weekends still trump weekdays when an attack took place.</span>
<span id="cb21-367"><a href="#cb21-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-368"><a href="#cb21-368" aria-hidden="true" tabindex="-1"></a><span class="fu"># Conclusions</span></span>
<span id="cb21-369"><a href="#cb21-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-370"><a href="#cb21-370" aria-hidden="true" tabindex="-1"></a>To wrap up, we found that attacks that were Exploits (Access Control, Flash Loan Attacks, and Phishing) were generally linked to the Ethereum chain and lost as well as recovered funds in the low millions (USD). The CEX cryptocurrency platform too was related to exploit attacks and were able to recover funds in the low millions (USD). Exit Scams comprising Honeypot attacks, Rugpull attacks, and Abandoned scams, on the other hand, were attacks that generally resulted in funds lost in the low millions (USD) but not being able to recover any funds. Exploit attacks were common on weekends rather than weekdays resulted in Our dataset was conducive to running the Apriori Algorithm on it; however, a larger dataset would take more time train on and may result in more insignificant rules to filter from. </span>
<span id="cb21-371"><a href="#cb21-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-372"><a href="#cb21-372" aria-hidden="true" tabindex="-1"></a><span class="fu"># References</span></span>
<span id="cb21-373"><a href="#cb21-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-374"><a href="#cb21-374" aria-hidden="true" tabindex="-1"></a>“Association Rule Learning.” Wikipedia. Wikimedia Foundation. Accessed December 1, 2022. https://en.wikipedia.org/wiki/Association_rule_learning. </span>
<span id="cb21-375"><a href="#cb21-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-376"><a href="#cb21-376" aria-hidden="true" tabindex="-1"></a>“Association Rules and the Apriori Algorithm: A Tutorial.” KDnuggets. Accessed December 1, 2022. https://www.kdnuggets.com/2016/04/association-rules-apriori-algorithm-tutorial.html. </span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>