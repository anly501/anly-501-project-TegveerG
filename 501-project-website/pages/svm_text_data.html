<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>svm_text_data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
    overflow: hidden;
    background-color: #041E42;
    max-width:1500px;
    height: 50px;
    font-size: small;
}

li {
    float: left;
    display: inline;
    vertical-align: middle;
}

li a, .dropbtn {
    display: inline-block;
    color: #D6D2C4;
    text-align: center;
    padding: 14px 16px;
    text-decoration: underline;
    font-weight: bold;
    outline: 0;
}

li a:hover, .dropdown:hover .dropbtn {
    background-color: #ffffff;
    z-index: 99;
}

li.dropdown {
    display: inline-block;
    z-index: 99;
}

.dropdown-content {
    display: none;
    position: absolute;
    background-color: #D6D2C4;
    min-width: 160px;   
}

.dropdown-content a {
    color: #000000;
    padding: 12px 16px;
    text-decoration: italic;
    display: block;
    text-align: left;
}

.dropdown:hover .dropdown-content {
    display: block;
    opacity: .6;

}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="svm_text_data_files/libs/clipboard/clipboard.min.js"></script>
<script src="svm_text_data_files/libs/quarto-html/quarto.js"></script>
<script src="svm_text_data_files/libs/quarto-html/popper.min.js"></script>
<script src="svm_text_data_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="svm_text_data_files/libs/quarto-html/anchor.min.js"></script>
<link href="svm_text_data_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="svm_text_data_files/libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="svm_text_data_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="svm_text_data_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="svm_text_data_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="fullcontent">

  <a href="https://analytics.georgetown.edu/" target="_blank">
    <img src="../../501-project-website/images/DSAN.jpeg" style="width:650px;height:200px;">
  </a>

  <a>
    <img src="../../501-project-website/images/healy_hall.jpeg" style="width:650px;height:200px;align-items: right;">
  </a>

  <a>
    <img src="../../501-project-website/images/Jack.jpeg" style="width: 180px;height:200px;align-items: right;">
  </a>


<ul>
  <!-- link back to homepage -->
  <li>
  <a href="../../501-project-website/index.html">About Me</a>
  </li>
  <li>
    <a href="https://github.com/anly501/anly-501-project-TegveerG/tree/main/codes/">Code</a>
</li>
<li>
  <a href="https://github.com/anly501/anly-501-project-TegveerG/tree/main/data">Data</a>
</li>
  <!-- tab without dropdown  -->
  <li>
  <a href="../../501-project-website/pages/Introduction.html">Introduction</a>
  </li>
  <!-- tab without dropdown  -->
  <li>
  <a href="../../501-project-website/pages/Data Gathering.html">Data Gathering</a>
  </li>
  <!-- tab without dropdown  -->
  <li>
  <a href="../../501-project-website/pages/Data-Cleaning-rmd.html">Data Cleaning</a>
  </li>
  <!-- tab without dropdown  -->
  <li>
  <a href="../../501-project-website/pages/Exploring-Data-rmd.html">Exploring Data</a>
  </li>
  <!-- tab without dropdown  -->
  <li>
  <a href="../../501-project-website/pages/Naive-Bayes-R.html">Naive Bayes</a>
  </li>
  <!-- tab without dropdown  -->
  <li>
  <a href="../../501-project-website/pages/decision_tree_record_data.html">Decision Trees</a>
  </li>
  <!-- tab without dropdown  -->
  <li>
  <a href="../../501-project-website/pages/svm_text_data.html">SVM</a>
  </li>
  <!-- tab without dropdown  -->
  <li>
  <a href="../../501-project-website/pages/clustering.html">Clustering</a>
  </li>
  <!-- tab without dropdown  -->
  <li>
  <a href="../../501-project-website/pages/ARM and Networking.html">ARM and Networking</a>
  </li>
  <!-- tab without dropdown  -->
  <li>
  <a href="../../501-project-website/pages/Conclusions.html">Conclusions</a>
  </li>
  </ul>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">



<section id="binary-classification-of-text-data-twitter-and-news-api-using-svm" class="level1">
<h1>Binary Classification of Text Data (Twitter and News API) Using SVM</h1>
<p>The purpose of this tab is to examine the performance of 4 different SVM kernels, namely Linear, Polynomial, RBF, and Sigmoid, on our cleaned text data gathered from Twitter and News APIs. If we recall, the Twitter and News text sentiment analyses represented that, on average, the tweets are composed of text with greater negative sentiment than that of the news content. Therefore, our data has a fair mix of positive and negative text, which means that our labels will not be heavily imbalanced!</p>
<section id="methods" class="level3">
<h3 class="anchored" data-anchor-id="methods">Methods</h3>
<p>Before we begin SVM modeling, we shall test our data on a random classifier, which is a baseline model, and output accuracy, precision, and recall values. We shall use sklearn’s train-test split function to divide the data into an 80-20 train-test split respectively. Next, we shall employ the 4 aforementioned SVM models and compare their overall performance with each other. We shall also perform hyperparameter tuning, including changing the regularization values from 0.1 to 10 for all models and changing the Gamma values from 1 to 0.001 for all models excluding the Linear SVM. Our goal is to try to achieve even better performances from all the 4 models using hyperparameter tuning and comparing the tuned models with the initial SVM models.</p>
</section>
<section id="results" class="level3">
<h3 class="anchored" data-anchor-id="results">Results</h3>
<p>Our combined dataset of tweets and news content included a total of 380 observations. We tested support vector machines and a random classifier on this data. The hyperparameter tuned RBF and Sigmoid SVM models had the highest classification accuracies at 83% and 82% respectively. However, the lowest accuracy was obtained from the initial Sigmoid SVM model with 71% accuracy. Therefore, hyperparameter tuning is an important step in the machine learning process and it opens insights on why and how a particular model performs when its parameters are dialed back and forth.</p>
</section>
<section id="load-the-cleaned-text-data" class="level3">
<h3 class="anchored" data-anchor-id="load-the-cleaned-text-data">Load the cleaned text data</h3>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;python&quot;}" data-execution_count="1">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix, ConfusionMatrixDisplay, classification_report</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">"ignore"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="exploring-the-dataset." class="level3">
<h3 class="anchored" data-anchor-id="exploring-the-dataset.">Exploring the dataset.</h3>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;python&quot;}" data-execution_count="2">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import data and show first 5 rows</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>tweets_news_clean <span class="op">=</span> pd.read_csv(<span class="st">"../../data/Clean Data/Clean_Tweets_News_Merged.csv"</span>, index_col<span class="op">=</span>[<span class="dv">0</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;python&quot;}" data-execution_count="3">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>tweets_news_clean.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="3">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Content_Lemmatized_Sentiment_Analysis</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>youre serious owning digital currency  need ha...</td>
      <td>Negative</td>
    </tr>
    <tr>
      <th>1</th>
      <td>wallet pocket store physical currency  crypto ...</td>
      <td>Positive</td>
    </tr>
    <tr>
      <th>2</th>
      <td>keep saf…  +3718 char  .pointed question coinb...</td>
      <td>Negative</td>
    </tr>
    <tr>
      <th>3</th>
      <td>olivia zollino report…  +1 char  .posted ether...</td>
      <td>Positive</td>
    </tr>
    <tr>
      <th>4</th>
      <td>julian satterthwaite report .. posted long-awa...</td>
      <td>Negative</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;python&quot;}" data-execution_count="4">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Data shape is: "</span>, tweets_news_clean.shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Data shape is:  (380, 2)</code></pre>
</div>
</div>
</section>
<section id="split-the-dataset-into-training-and-testing-sets" class="level3">
<h3 class="anchored" data-anchor-id="split-the-dataset-into-training-and-testing-sets">Split the dataset into training and testing sets</h3>
<p>Sentiment is the dependent variable and the bag-of-words is our independent variable. The raw independent variable of lemmatized and cleaned texts of Twiiter and News API are turned into a bag-of-words document using CountVectorizer().</p>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;python&quot;}" data-execution_count="5">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the dataframe into X and y and then split X and y into train and test sets.</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.feature_extraction.text <span class="im">import</span> CountVectorizer</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">3737</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> tweets_news_clean[<span class="st">"Content_Lemmatized_Sentiment_Analysis"</span>]</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> tweets_news_clean[<span class="st">"label"</span>]</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>x_train, x_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, </span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    random_state <span class="op">=</span> <span class="dv">1</span>,test_size<span class="op">=</span><span class="fl">0.2</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>count_vector <span class="op">=</span> CountVectorizer()</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>training_data <span class="op">=</span> count_vector.fit_transform(x_train)</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>testing_data <span class="op">=</span> count_vector.transform(x_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;python&quot;}" data-execution_count="6">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the shape of the train and test sets, and levels of the dependent variable (Y) </span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Shape of x_train is: "</span>, x_train.shape)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Shape of x_test is: "</span>,x_test.shape)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Shape of y_train is: "</span>,y_train.shape)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Shape of y_test is: "</span>,y_test.shape)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The levels of the dependent variable (Sentiment) are:"</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(y.value_counts())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Shape of x_train is:  (304,)
Shape of x_test is:  (76,)
Shape of y_train is:  (304,)
Shape of y_test is:  (76,)
The levels of the dependent variable (Sentiment) are:
Negative    205
Positive    175
Name: label, dtype: int64</code></pre>
</div>
</div>
</section>
<section id="baseline-classifier" class="level2">
<h2 class="anchored" data-anchor-id="baseline-classifier">Baseline Classifier</h2>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;python&quot;}" data-execution_count="7">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> Counter</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> precision_recall_fscore_support</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;python&quot;}" data-execution_count="8">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">## RANDOM CLASSIFIER </span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> random_classifier(y_data):</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    ypred<span class="op">=</span>[]</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    max_label<span class="op">=</span>np.<span class="bu">max</span>(y_data)<span class="op">;</span> <span class="co">#print(max_label)</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>,<span class="bu">len</span>(y_data)):</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>        ypred.append(<span class="bu">int</span>(np.floor((max_label<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>np.random.uniform(<span class="dv">0</span>,<span class="dv">1</span>))))</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n\n</span><span class="st">-----RANDOM CLASSIFIER-----"</span>)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"count of prediction:"</span>,Counter(ypred).values()) <span class="co"># counts the elements' frequency</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"probability of prediction:"</span>,np.fromiter(Counter(ypred).values(), dtype<span class="op">=</span><span class="bu">float</span>)<span class="op">/</span><span class="bu">len</span>(y_data)) <span class="co"># counts the elements' frequency</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"accuracy"</span>,accuracy_score(y_data, ypred))</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"precision, recall, fscore, support"</span>,precision_recall_fscore_support(y_data, ypred))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;python&quot;}" data-execution_count="9">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> preprocessing</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># label_encoder object knows how to understand word labels.</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>label_encoder <span class="op">=</span> preprocessing.LabelEncoder()</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Encode labels in column 'species'.</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>y_encoded <span class="op">=</span> label_encoder.fit_transform(y)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">BINARY CLASS: NON-UNIFORM LOAD (Positive: 175 count, Negative: 205 count"</span>)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Unique labels and respective counts after one-hot encoding: "</span>)</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"0 = Negative and 1 = Positive"</span>)</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>unique, counts <span class="op">=</span> np.unique(y_encoded, return_counts<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.asarray((unique, counts)).T)</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>random_classifier(y_encoded)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
BINARY CLASS: NON-UNIFORM LOAD (Positive: 175 count, Negative: 205 count
Unique labels and respective counts after one-hot encoding: 
0 = Negative and 1 = Positive
[[  0 205]
 [  1 175]]


-----RANDOM CLASSIFIER-----
count of prediction: dict_values([202, 178])
probability of prediction: [0.53157895 0.46842105]
accuracy 0.5447368421052632
precision, recall, fscore, support (array([0.57920792, 0.50561798]), array([0.57073171, 0.51428571]), array([0.57493857, 0.50991501]), array([205, 175]))</code></pre>
</div>
</div>
<p>The baseline classifier outputs an overall accuracy of 54% and an f-1 score of 0.57493857 for Negative labels and 0.50991501 for Positive labels respectively. The Linear SVM kernel should perform better than this, let’s find out…</p>
</section>
<section id="svm-with-linear-kernels" class="level2">
<h2 class="anchored" data-anchor-id="svm-with-linear-kernels">SVM with Linear kernels</h2>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;python&quot;}" data-execution_count="10">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import svc from sklearn.svm and classsification_report, confusion_matrix from sklearn.metrics.</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the classfier on the training data and predict on the test data. Set the classifier to be linear and C between 0.35-0.75. </span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.svm <span class="im">import</span> SVC</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> SVC(C<span class="op">=</span><span class="fl">0.45</span>, kernel<span class="op">=</span><span class="st">'linear'</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>clf.fit(training_data, y_train)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>yp_train <span class="op">=</span> clf.predict(training_data)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>yp_test <span class="op">=</span> clf.predict(testing_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;python&quot;}" data-execution_count="11">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the confusion matrix and classification report for the train and test data. </span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>cm_train <span class="op">=</span> confusion_matrix(y_train, yp_train, labels<span class="op">=</span>clf.classes_)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>cm_test <span class="op">=</span> confusion_matrix(y_test, yp_test, labels<span class="op">=</span>clf.classes_)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>target_names <span class="op">=</span> [<span class="st">'Positive'</span>, <span class="st">'Negative'</span>]</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>clf_report_train_linear <span class="op">=</span> classification_report(y_train, yp_train, target_names<span class="op">=</span>target_names, output_dict<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>clf_report_test_linear <span class="op">=</span> classification_report(y_test, yp_test, target_names<span class="op">=</span>target_names, output_dict<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;python&quot;}" data-execution_count="12">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the results in a data frame. </span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>clf_report_train_linear <span class="op">=</span> pd.DataFrame(clf_report_train_linear).transpose()</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>clf_report_test_linear <span class="op">=</span> pd.DataFrame(clf_report_test_linear).transpose()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;python&quot;}" data-execution_count="13">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Classification Report of Linear SVM Train Data:"</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>clf_report_train_linear</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Classification Report of Linear SVM Train Data:</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="13">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>precision</th>
      <th>recall</th>
      <th>f1-score</th>
      <th>support</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Positive</th>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>170.0</td>
    </tr>
    <tr>
      <th>Negative</th>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>134.0</td>
    </tr>
    <tr>
      <th>accuracy</th>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>macro avg</th>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>304.0</td>
    </tr>
    <tr>
      <th>weighted avg</th>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>304.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;python&quot;}" data-execution_count="14">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Classification Report of Linear SVM Test Data:"</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>clf_report_test_linear</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Classification Report of Linear SVM Test Data:</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="14">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>precision</th>
      <th>recall</th>
      <th>f1-score</th>
      <th>support</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Positive</th>
      <td>0.805556</td>
      <td>0.828571</td>
      <td>0.816901</td>
      <td>35.000000</td>
    </tr>
    <tr>
      <th>Negative</th>
      <td>0.850000</td>
      <td>0.829268</td>
      <td>0.839506</td>
      <td>41.000000</td>
    </tr>
    <tr>
      <th>accuracy</th>
      <td>0.828947</td>
      <td>0.828947</td>
      <td>0.828947</td>
      <td>0.828947</td>
    </tr>
    <tr>
      <th>macro avg</th>
      <td>0.827778</td>
      <td>0.828920</td>
      <td>0.828204</td>
      <td>76.000000</td>
    </tr>
    <tr>
      <th>weighted avg</th>
      <td>0.829532</td>
      <td>0.828947</td>
      <td>0.829096</td>
      <td>76.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;python&quot;}" data-execution_count="15">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display Confusion Matrix for the test data. Remember to use the ConfusionMatrixDisplay function.</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">6</span>), dpi<span class="op">=</span><span class="dv">120</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>disp <span class="op">=</span> ConfusionMatrixDisplay(confusion_matrix<span class="op">=</span>cm_test, display_labels<span class="op">=</span>clf.classes_)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>disp.plot(ax<span class="op">=</span>ax, cmap<span class="op">=</span>plt.cm.Blues, values_format<span class="op">=</span><span class="st">'d'</span>, xticks_rotation<span class="op">=</span><span class="st">'vertical'</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Confusion Matrix: Linear SVM Test Data"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>Text(0.5, 1.0, 'Confusion Matrix: Linear SVM Test Data')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="svm_text_data_files/figure-html/cell-16-output-2.png" class="img-fluid"></p>
</div>
</div>
<section id="hyper-parameter-tuning-using-gridsearchcv-evaluating-best-svc-regularization-for-linear-kernel" class="level3">
<h3 class="anchored" data-anchor-id="hyper-parameter-tuning-using-gridsearchcv-evaluating-best-svc-regularization-for-linear-kernel">Hyper-parameter tuning using GridSearchCV: Evaluating Best SVC Regularization for Linear Kernel</h3>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;python&quot;}" data-execution_count="16">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.svm <span class="im">import</span> SVC</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> GridSearchCV  </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co"># defining parameter range</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>param_grid <span class="op">=</span> {<span class="st">'C'</span>: [<span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">0.7</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">10</span>], </span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>              <span class="st">'kernel'</span>: [<span class="st">'linear'</span>]} </span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>grid <span class="op">=</span> GridSearchCV(SVC(), param_grid, refit <span class="op">=</span> <span class="va">True</span>, verbose <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>grid.fit(training_data, y_train)</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="co"># print best parameter after tuning</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The best parameters after tuning are: "</span>, grid.best_params_)</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a><span class="co"># print how our model looks after hyper-parameter tuning</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The best model after tuning looks like: "</span>,grid.best_estimator_)</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>grid_predictions <span class="op">=</span> grid.predict(testing_data)</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a><span class="co"># print classification report</span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_test, grid_predictions))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>The best parameters after tuning are:  {'C': 5, 'kernel': 'linear'}
The best model after tuning looks like:  SVC(C=5, kernel='linear')
              precision    recall  f1-score   support

    Negative       0.80      0.80      0.80        35
    Positive       0.83      0.83      0.83        41

    accuracy                           0.82        76
   macro avg       0.81      0.81      0.81        76
weighted avg       0.82      0.82      0.82        76
</code></pre>
</div>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;python&quot;}" data-execution_count="17">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display Confusion Matrix for the above hyperparameter model.</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>cm_test <span class="op">=</span> confusion_matrix(y_test, grid_predictions, labels<span class="op">=</span>grid.classes_)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">6</span>), dpi<span class="op">=</span><span class="dv">120</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>disp <span class="op">=</span> ConfusionMatrixDisplay(confusion_matrix<span class="op">=</span>cm_test, display_labels<span class="op">=</span>clf.classes_)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>disp.plot(ax<span class="op">=</span>ax, cmap<span class="op">=</span>plt.cm.Blues, values_format<span class="op">=</span><span class="st">'d'</span>, xticks_rotation<span class="op">=</span><span class="st">'vertical'</span>)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>title_font <span class="op">=</span> {<span class="st">'size'</span>:<span class="st">'10'</span>}</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"GridSearchCV Confusion Matrix: Linear SVM Test Data"</span>, <span class="op">**</span>title_font)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>Text(0.5, 1.0, 'GridSearchCV Confusion Matrix: Linear SVM Test Data')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="svm_text_data_files/figure-html/cell-18-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>Therefore, after performing hyperparameter tuning, the performance of the Linear SVM model remains same. This means that we had initially selected the best model before performing hyperparameter tuning for Linear SVM. Let’s see if we can gain a better accuracy using Polynomial SVM kernels…</p>
</section>
</section>
<section id="svm-with-polynomial-kernels" class="level2">
<h2 class="anchored" data-anchor-id="svm-with-polynomial-kernels">SVM with Polynomial kernels</h2>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;python&quot;}" data-execution_count="18">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the classfier on the training data and predict on the test data. Set the classifier to be polynomial.</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> SVC(C<span class="op">=</span><span class="fl">0.45</span>, kernel <span class="op">=</span> <span class="st">'poly'</span>, degree<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>clf.fit(training_data, y_train)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>yp_train <span class="op">=</span> clf.predict(training_data)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>yp_test <span class="op">=</span> clf.predict(testing_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;python&quot;}" data-execution_count="19">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the confusion matrix and classification report for the train and test data. </span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>cm_train <span class="op">=</span> confusion_matrix(y_train, yp_train, labels<span class="op">=</span>clf.classes_)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>cm_test <span class="op">=</span> confusion_matrix(y_test, yp_test, labels<span class="op">=</span>clf.classes_)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>clf_report_train_poly <span class="op">=</span> classification_report(y_train, yp_train, target_names<span class="op">=</span>target_names, output_dict<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>clf_report_test_poly <span class="op">=</span> classification_report(y_test, yp_test, target_names<span class="op">=</span>target_names, output_dict<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;python&quot;}" data-execution_count="20">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the results in a data frame.</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>clf_report_train_poly <span class="op">=</span> pd.DataFrame(clf_report_train_poly).transpose()</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>clf_report_test_poly <span class="op">=</span> pd.DataFrame(clf_report_test_poly).transpose()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;python&quot;}" data-execution_count="21">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Classification Report of Polynomial SVM Train Data:"</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>clf_report_train_poly</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Classification Report of Polynomial SVM Train Data:</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="21">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>precision</th>
      <th>recall</th>
      <th>f1-score</th>
      <th>support</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Positive</th>
      <td>0.951220</td>
      <td>0.688235</td>
      <td>0.798635</td>
      <td>170.000000</td>
    </tr>
    <tr>
      <th>Negative</th>
      <td>0.707182</td>
      <td>0.955224</td>
      <td>0.812698</td>
      <td>134.000000</td>
    </tr>
    <tr>
      <th>accuracy</th>
      <td>0.805921</td>
      <td>0.805921</td>
      <td>0.805921</td>
      <td>0.805921</td>
    </tr>
    <tr>
      <th>macro avg</th>
      <td>0.829201</td>
      <td>0.821730</td>
      <td>0.805667</td>
      <td>304.000000</td>
    </tr>
    <tr>
      <th>weighted avg</th>
      <td>0.843650</td>
      <td>0.805921</td>
      <td>0.804834</td>
      <td>304.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;python&quot;}" data-execution_count="22">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Classification Report of Polynomial SVM Test Data:"</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>clf_report_test_poly</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Classification Report of Polynomial SVM Test Data:</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="22">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>precision</th>
      <th>recall</th>
      <th>f1-score</th>
      <th>support</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Positive</th>
      <td>0.787879</td>
      <td>0.742857</td>
      <td>0.764706</td>
      <td>35.000000</td>
    </tr>
    <tr>
      <th>Negative</th>
      <td>0.790698</td>
      <td>0.829268</td>
      <td>0.809524</td>
      <td>41.000000</td>
    </tr>
    <tr>
      <th>accuracy</th>
      <td>0.789474</td>
      <td>0.789474</td>
      <td>0.789474</td>
      <td>0.789474</td>
    </tr>
    <tr>
      <th>macro avg</th>
      <td>0.789288</td>
      <td>0.786063</td>
      <td>0.787115</td>
      <td>76.000000</td>
    </tr>
    <tr>
      <th>weighted avg</th>
      <td>0.789400</td>
      <td>0.789474</td>
      <td>0.788884</td>
      <td>76.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;python&quot;}" data-execution_count="23">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display Confusion Matrix for the test data. Remember to use the ConfusionMatrixDisplay function.</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">6</span>), dpi<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>disp <span class="op">=</span> ConfusionMatrixDisplay(confusion_matrix<span class="op">=</span>cm_test, display_labels<span class="op">=</span>clf.classes_)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>disp.plot(ax<span class="op">=</span>ax, cmap<span class="op">=</span>plt.cm.Blues, values_format<span class="op">=</span><span class="st">'d'</span>, xticks_rotation<span class="op">=</span><span class="st">'vertical'</span>)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Confusion Matrix: Polynomial SVM Test Data"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>Text(0.5, 1.0, 'Confusion Matrix: Polynomial SVM Test Data')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="svm_text_data_files/figure-html/cell-24-output-2.png" class="img-fluid"></p>
</div>
</div>
<section id="hyper-parameter-tuning-using-gridsearchcv-evaluating-best-svc-regularization-and-gamma-for-poly-kernel" class="level3">
<h3 class="anchored" data-anchor-id="hyper-parameter-tuning-using-gridsearchcv-evaluating-best-svc-regularization-and-gamma-for-poly-kernel">Hyper-parameter tuning using GridSearchCV: Evaluating Best SVC Regularization and Gamma for Poly Kernel</h3>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;python&quot;}" data-execution_count="24">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># defining parameter range</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>param_grid <span class="op">=</span> {<span class="st">'C'</span>: [<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">5</span>], </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>              <span class="st">'gamma'</span>: [<span class="dv">1</span>, <span class="fl">0.1</span>, <span class="fl">0.01</span>, <span class="fl">0.001</span>],</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>              <span class="st">'kernel'</span>: [<span class="st">'poly'</span>]} </span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>grid <span class="op">=</span> GridSearchCV(SVC(), param_grid, refit <span class="op">=</span> <span class="va">True</span>, verbose <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>grid.fit(training_data, y_train)</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="co"># print best parameter after tuning</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The best parameters after tuning are: "</span>, grid.best_params_)</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a><span class="co"># print how our model looks after hyper-parameter tuning</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The best model after tuning looks like: "</span>,grid.best_estimator_)</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>grid_predictions <span class="op">=</span> grid.predict(testing_data)</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a><span class="co"># print classification report</span></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_test, grid_predictions))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>The best parameters after tuning are:  {'C': 0.5, 'gamma': 1, 'kernel': 'poly'}
The best model after tuning looks like:  SVC(C=0.5, gamma=1, kernel='poly')
              precision    recall  f1-score   support

    Negative       0.76      0.74      0.75        35
    Positive       0.79      0.80      0.80        41

    accuracy                           0.78        76
   macro avg       0.78      0.77      0.77        76
weighted avg       0.78      0.78      0.78        76
</code></pre>
</div>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;python&quot;}" data-execution_count="25">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display Confusion Matrix for the above hyperparameter model.</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>cm_test <span class="op">=</span> confusion_matrix(y_test, grid_predictions, labels<span class="op">=</span>grid.classes_)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">6</span>), dpi<span class="op">=</span><span class="dv">120</span>)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>disp <span class="op">=</span> ConfusionMatrixDisplay(confusion_matrix<span class="op">=</span>cm_test, display_labels<span class="op">=</span>clf.classes_)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>disp.plot(ax<span class="op">=</span>ax, cmap<span class="op">=</span>plt.cm.Blues, values_format<span class="op">=</span><span class="st">'d'</span>, xticks_rotation<span class="op">=</span><span class="st">'vertical'</span>)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>title_font <span class="op">=</span> {<span class="st">'size'</span>:<span class="st">'10'</span>}</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"GridSearchCV Confusion Matrix: Polynomial SVM Test Data"</span>, <span class="op">**</span>title_font)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>Text(0.5, 1.0, 'GridSearchCV Confusion Matrix: Polynomial SVM Test Data')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="svm_text_data_files/figure-html/cell-26-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>Therefore, after performing hyperparameter tuning, the performance of the Polynomial SVM model remains same. This means that we had initially selected the best model before performing hyperparameter tuning for Polynomial SVM. Even after setting different gamma values and regularization parameters, the initial model is as good as the hyperparameterized model. Moreover, the weighted overall accuracy is 3% lower than that of the Linear SVM models! Probably our “easy-to-learn” data does not require more complex models than Linear SVM. However, let’s see if we can still gain a better accuracy using RBF SVM kernels (best-performing SVM kernel)…</p>
</section>
</section>
<section id="svm-with-rbf-kernels" class="level2">
<h2 class="anchored" data-anchor-id="svm-with-rbf-kernels">SVM with RBF kernels</h2>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;python&quot;}" data-execution_count="26">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the classfier on the training data and predict on the test data. Set the classifier to be linear and C between 0.35-0.75. </span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> SVC(C<span class="op">=</span><span class="fl">0.45</span>, kernel <span class="op">=</span> <span class="st">'rbf'</span>)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>clf.fit(training_data, y_train)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>yp_train <span class="op">=</span> clf.predict(training_data)</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>yp_test <span class="op">=</span> clf.predict(testing_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;python&quot;}" data-execution_count="27">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the confusion matrix and classification report for the train and test data. </span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>cm_train <span class="op">=</span> confusion_matrix(y_train, yp_train, labels<span class="op">=</span>clf.classes_)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>cm_test <span class="op">=</span> confusion_matrix(y_test, yp_test, labels<span class="op">=</span>clf.classes_)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>clf_report_train_RBF <span class="op">=</span> classification_report(y_train, yp_train, target_names<span class="op">=</span>target_names, output_dict<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>clf_report_test_RBF <span class="op">=</span> classification_report(y_test, yp_test, target_names<span class="op">=</span>target_names, output_dict<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;python&quot;}" data-execution_count="28">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the results in a data frame.</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>clf_report_train_RBF <span class="op">=</span> pd.DataFrame(clf_report_train_RBF).transpose()</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>clf_report_test_RBF <span class="op">=</span> pd.DataFrame(clf_report_test_RBF).transpose()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;python&quot;}" data-execution_count="29">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Classification Report of RBF SVM Train Data:"</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>clf_report_train_RBF</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Classification Report of RBF SVM Train Data:</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="29">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>precision</th>
      <th>recall</th>
      <th>f1-score</th>
      <th>support</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Positive</th>
      <td>0.933333</td>
      <td>0.658824</td>
      <td>0.772414</td>
      <td>170.000000</td>
    </tr>
    <tr>
      <th>Negative</th>
      <td>0.684783</td>
      <td>0.940299</td>
      <td>0.792453</td>
      <td>134.000000</td>
    </tr>
    <tr>
      <th>accuracy</th>
      <td>0.782895</td>
      <td>0.782895</td>
      <td>0.782895</td>
      <td>0.782895</td>
    </tr>
    <tr>
      <th>macro avg</th>
      <td>0.809058</td>
      <td>0.799561</td>
      <td>0.782433</td>
      <td>304.000000</td>
    </tr>
    <tr>
      <th>weighted avg</th>
      <td>0.823775</td>
      <td>0.782895</td>
      <td>0.781247</td>
      <td>304.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;python&quot;}" data-execution_count="30">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Classification Report of RBF SVM Test Data:"</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>clf_report_test_RBF</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Classification Report of RBF SVM Test Data:</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="30">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>precision</th>
      <th>recall</th>
      <th>f1-score</th>
      <th>support</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Positive</th>
      <td>0.806452</td>
      <td>0.714286</td>
      <td>0.757576</td>
      <td>35.000000</td>
    </tr>
    <tr>
      <th>Negative</th>
      <td>0.777778</td>
      <td>0.853659</td>
      <td>0.813953</td>
      <td>41.000000</td>
    </tr>
    <tr>
      <th>accuracy</th>
      <td>0.789474</td>
      <td>0.789474</td>
      <td>0.789474</td>
      <td>0.789474</td>
    </tr>
    <tr>
      <th>macro avg</th>
      <td>0.792115</td>
      <td>0.783972</td>
      <td>0.785765</td>
      <td>76.000000</td>
    </tr>
    <tr>
      <th>weighted avg</th>
      <td>0.790983</td>
      <td>0.789474</td>
      <td>0.787990</td>
      <td>76.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;python&quot;}" data-execution_count="31">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display Confusion Matrix for the test data. Remember to use the ConfusionMatrixDisplay function.</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">6</span>), dpi<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>disp <span class="op">=</span> ConfusionMatrixDisplay(confusion_matrix<span class="op">=</span>cm_test, display_labels<span class="op">=</span>clf.classes_)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>disp.plot(ax<span class="op">=</span>ax, cmap<span class="op">=</span>plt.cm.Blues, values_format<span class="op">=</span><span class="st">'d'</span>, xticks_rotation<span class="op">=</span><span class="st">'vertical'</span>)</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Confusion Matrix: RBF SVM Test Data"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>Text(0.5, 1.0, 'Confusion Matrix: RBF SVM Test Data')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="svm_text_data_files/figure-html/cell-32-output-2.png" class="img-fluid"></p>
</div>
</div>
<section id="hyper-parameter-tuning-using-gridsearchcv-evaluating-best-svc-regularization-and-gamma-for-rbf-kernel" class="level3">
<h3 class="anchored" data-anchor-id="hyper-parameter-tuning-using-gridsearchcv-evaluating-best-svc-regularization-and-gamma-for-rbf-kernel">Hyper-parameter tuning using GridSearchCV: Evaluating Best SVC Regularization and Gamma for RBF Kernel</h3>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;python&quot;}" data-execution_count="32">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># defining parameter range</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>param_grid <span class="op">=</span> {<span class="st">'C'</span>: [<span class="fl">0.1</span>, <span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">1000</span>], </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>              <span class="st">'gamma'</span>: [<span class="dv">1</span>, <span class="fl">0.1</span>, <span class="fl">0.01</span>, <span class="fl">0.001</span>, <span class="fl">0.0001</span>],</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>              <span class="st">'kernel'</span>: [<span class="st">'rbf'</span>]}</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>grid <span class="op">=</span> GridSearchCV(SVC(), param_grid, refit <span class="op">=</span> <span class="va">True</span>, verbose <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>grid.fit(training_data, y_train)</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a><span class="co"># print best parameter after tuning</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The best parameters after tuning are: "</span>, grid.best_params_)</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a><span class="co"># print how our model looks after hyper-parameter tuning</span></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The best model after tuning looks like: "</span>,grid.best_estimator_)</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>grid_predictions <span class="op">=</span> grid.predict(testing_data)</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a><span class="co"># print classification report</span></span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_test, grid_predictions))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>The best parameters after tuning are:  {'C': 10, 'gamma': 0.01, 'kernel': 'rbf'}
The best model after tuning looks like:  SVC(C=10, gamma=0.01)
              precision    recall  f1-score   support

    Negative       0.81      0.83      0.82        35
    Positive       0.85      0.83      0.84        41

    accuracy                           0.83        76
   macro avg       0.83      0.83      0.83        76
weighted avg       0.83      0.83      0.83        76
</code></pre>
</div>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;python&quot;}" data-execution_count="33">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display Confusion Matrix for the above hyperparameter model.</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>cm_test <span class="op">=</span> confusion_matrix(y_test, grid_predictions, labels<span class="op">=</span>grid.classes_)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">6</span>), dpi<span class="op">=</span><span class="dv">120</span>)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>disp <span class="op">=</span> ConfusionMatrixDisplay(confusion_matrix<span class="op">=</span>cm_test, display_labels<span class="op">=</span>clf.classes_)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>disp.plot(ax<span class="op">=</span>ax, cmap<span class="op">=</span>plt.cm.Blues, values_format<span class="op">=</span><span class="st">'d'</span>, xticks_rotation<span class="op">=</span><span class="st">'vertical'</span>)</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>title_font <span class="op">=</span> {<span class="st">'size'</span>:<span class="st">'10'</span>}</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"GridSearchCV Confusion Matrix: RBF SVM Test Data"</span>, <span class="op">**</span>title_font)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="33">
<pre><code>Text(0.5, 1.0, 'GridSearchCV Confusion Matrix: RBF SVM Test Data')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="svm_text_data_files/figure-html/cell-34-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>Therefore, after performing hyperparameter tuning, the performance of the RBF SVM model increased! This means that our initially selected model had scope for improvement in terms of weighted accuracy and f-1 score. Moreover, the hyperparameter tuned Polynomial SVM performed better than all other SVM models.The weighted overall accuracy is 4% higher than that of the initial RBF SVM model! As mentioned, earlier, the RBF SVM is the best-performing kernel and we have reinforced it through the above analysis. Now, let’s see if we can at least match RBF SVM’s performance using a Sigmoid SVM kernel…</p>
</section>
</section>
<section id="svm-with-sigmoid-kernels" class="level2">
<h2 class="anchored" data-anchor-id="svm-with-sigmoid-kernels">SVM with Sigmoid Kernels</h2>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;python&quot;}" data-execution_count="34">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import svc from sklearn.svm and classsification_report, confusion_matrix from sklearn.metrics.</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the classfier on the training data and predict on the test data. Set the classifier to be linear and C between 0.35-0.75. </span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> SVC(C<span class="op">=</span><span class="fl">0.45</span>, kernel <span class="op">=</span> <span class="st">'sigmoid'</span>)</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>clf.fit(training_data, y_train)</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>yp_train <span class="op">=</span> clf.predict(training_data)</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>yp_test <span class="op">=</span> clf.predict(testing_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;python&quot;}" data-execution_count="35">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the confusion matrix and classification report for the train and test data. </span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>cm_train <span class="op">=</span> confusion_matrix(y_train, yp_train, labels<span class="op">=</span>clf.classes_)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>cm_test <span class="op">=</span> confusion_matrix(y_test, yp_test, labels<span class="op">=</span>clf.classes_)</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>clf_report_train_sigmoid <span class="op">=</span> classification_report(y_train, yp_train, target_names<span class="op">=</span>target_names, output_dict<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>clf_report_test_sigmoid <span class="op">=</span> classification_report(y_test, yp_test, target_names<span class="op">=</span>target_names, output_dict<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;python&quot;}" data-execution_count="36">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the results in a data frame.</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>clf_report_train_sigmoid <span class="op">=</span> pd.DataFrame(clf_report_train_sigmoid).transpose()</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>clf_report_test_sigmoid <span class="op">=</span> pd.DataFrame(clf_report_test_sigmoid).transpose()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;python&quot;}" data-execution_count="37">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Classification Report of Sigmoid SVM Train Data:"</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>clf_report_train_sigmoid </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Classification Report of Sigmoid SVM Train Data:</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="37">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>precision</th>
      <th>recall</th>
      <th>f1-score</th>
      <th>support</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Positive</th>
      <td>0.966292</td>
      <td>0.505882</td>
      <td>0.664093</td>
      <td>170.000000</td>
    </tr>
    <tr>
      <th>Negative</th>
      <td>0.609302</td>
      <td>0.977612</td>
      <td>0.750716</td>
      <td>134.000000</td>
    </tr>
    <tr>
      <th>accuracy</th>
      <td>0.713816</td>
      <td>0.713816</td>
      <td>0.713816</td>
      <td>0.713816</td>
    </tr>
    <tr>
      <th>macro avg</th>
      <td>0.787797</td>
      <td>0.741747</td>
      <td>0.707404</td>
      <td>304.000000</td>
    </tr>
    <tr>
      <th>weighted avg</th>
      <td>0.808935</td>
      <td>0.713816</td>
      <td>0.702275</td>
      <td>304.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;python&quot;}" data-execution_count="38">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Classification Report of Sigmoid SVM Test Data:"</span>)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>clf_report_test_sigmoid </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Classification Report of Sigmoid SVM Test Data:</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="38">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>precision</th>
      <th>recall</th>
      <th>f1-score</th>
      <th>support</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Positive</th>
      <td>0.833333</td>
      <td>0.571429</td>
      <td>0.677966</td>
      <td>35.00</td>
    </tr>
    <tr>
      <th>Negative</th>
      <td>0.711538</td>
      <td>0.902439</td>
      <td>0.795699</td>
      <td>41.00</td>
    </tr>
    <tr>
      <th>accuracy</th>
      <td>0.750000</td>
      <td>0.750000</td>
      <td>0.750000</td>
      <td>0.75</td>
    </tr>
    <tr>
      <th>macro avg</th>
      <td>0.772436</td>
      <td>0.736934</td>
      <td>0.736833</td>
      <td>76.00</td>
    </tr>
    <tr>
      <th>weighted avg</th>
      <td>0.767628</td>
      <td>0.750000</td>
      <td>0.741480</td>
      <td>76.00</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;python&quot;}" data-execution_count="39">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display Confusion Matrix for the test data. Remember to use the ConfusionMatrixDisplay function.</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">6</span>), dpi<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>disp <span class="op">=</span> ConfusionMatrixDisplay(confusion_matrix<span class="op">=</span>cm_test, display_labels<span class="op">=</span>clf.classes_)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>disp.plot(ax<span class="op">=</span>ax, cmap<span class="op">=</span>plt.cm.Blues, values_format<span class="op">=</span><span class="st">'d'</span>, xticks_rotation<span class="op">=</span><span class="st">'vertical'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="39">
<pre><code>&lt;sklearn.metrics._plot.confusion_matrix.ConfusionMatrixDisplay at 0x153d17cd0&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="svm_text_data_files/figure-html/cell-40-output-2.png" class="img-fluid"></p>
</div>
</div>
<section id="hyper-parameter-tuning-using-gridsearchcv-evaluating-best-svc-regularization-and-gamma-for-sigmoid-kernel" class="level3">
<h3 class="anchored" data-anchor-id="hyper-parameter-tuning-using-gridsearchcv-evaluating-best-svc-regularization-and-gamma-for-sigmoid-kernel">Hyper-parameter tuning using GridSearchCV: Evaluating Best SVC Regularization and Gamma for Sigmoid Kernel</h3>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;python&quot;}" data-execution_count="40">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># defining parameter range</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>param_grid <span class="op">=</span> {<span class="st">'C'</span>: [<span class="fl">0.1</span>, <span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">1000</span>], </span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>              <span class="st">'gamma'</span>: [<span class="dv">1</span>, <span class="fl">0.1</span>, <span class="fl">0.01</span>, <span class="fl">0.001</span>, <span class="fl">0.0001</span>],</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>              <span class="st">'kernel'</span>: [<span class="st">'sigmoid'</span>]}</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>grid <span class="op">=</span> GridSearchCV(SVC(), param_grid, refit <span class="op">=</span> <span class="va">True</span>, verbose <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>grid.fit(training_data, y_train)</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a><span class="co"># print best parameter after tuning</span></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The best parameters after tuning are: "</span>, grid.best_params_)</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a><span class="co"># print how our model looks after hyper-parameter tuning</span></span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The best model after tuning looks like: "</span>,grid.best_estimator_)</span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>grid_predictions <span class="op">=</span> grid.predict(testing_data)</span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a><span class="co"># print classification report</span></span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_test, grid_predictions))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>The best parameters after tuning are:  {'C': 100, 'gamma': 0.001, 'kernel': 'sigmoid'}
The best model after tuning looks like:  SVC(C=100, gamma=0.001, kernel='sigmoid')
              precision    recall  f1-score   support

    Negative       0.80      0.80      0.80        35
    Positive       0.83      0.83      0.83        41

    accuracy                           0.82        76
   macro avg       0.81      0.81      0.81        76
weighted avg       0.82      0.82      0.82        76
</code></pre>
</div>
</div>
<div class="cell" data-vscode="{&quot;languageId&quot;:&quot;python&quot;}" data-execution_count="41">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display Confusion Matrix for the above hyperparameter model.</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>cm_test <span class="op">=</span> confusion_matrix(y_test, grid_predictions, labels<span class="op">=</span>grid.classes_)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">6</span>), dpi<span class="op">=</span><span class="dv">120</span>)</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>disp <span class="op">=</span> ConfusionMatrixDisplay(confusion_matrix<span class="op">=</span>cm_test, display_labels<span class="op">=</span>clf.classes_)</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>disp.plot(ax<span class="op">=</span>ax, cmap<span class="op">=</span>plt.cm.Blues, values_format<span class="op">=</span><span class="st">'d'</span>, xticks_rotation<span class="op">=</span><span class="st">'vertical'</span>)</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>title_font <span class="op">=</span> {<span class="st">'size'</span>:<span class="st">'10'</span>}</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"GridSearchCV Confusion Matrix: Sigmoid SVM Test Data"</span>, <span class="op">**</span>title_font)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="41">
<pre><code>Text(0.5, 1.0, 'GridSearchCV Confusion Matrix: Sigmoid SVM Test Data')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="svm_text_data_files/figure-html/cell-42-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>Therefore, after performing hyperparameter tuning, the performance of the Sigmoid SVM model increased and the increase in performance is almost as good as the hyperparameter tuned RBF model! Surprisingly, the initial Sigmoid SVM’s performance was the worst out of all other models! This means that our initially selected model indubitably had scope for improvement in terms of weighted accuracy and f-1 score. The weighted overall accuracy of the Sigmoid hyperparameter tuned model is 11% higher than that of the initial Sigmoid SVM model! The overall results of this analysis help us conclude that the RBF and Sigmoid SVM’s are the most powerful when it comes to predicting labeled text data that has been transformed into a bag-of-words using count vectorizer.</p>
<!-- -->

</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb65" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="co">    backgroundcolor: "#63666A"</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="co">    fontcolor: white</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a><span class="co">    linkcolor: black</span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a><span class="co">    df-print: paged</span></span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a><span class="co">    highlight-style: vim-dark</span></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a><span class="an">jupyter:</span><span class="co"> python3</span></span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a><span class="fu"># Binary Classification of Text Data (Twitter and News API) Using SVM</span></span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a>The purpose of this tab is to examine the performance of 4 different SVM kernels, namely Linear, Polynomial, RBF, and Sigmoid, on our cleaned text data gathered from Twitter and News APIs. If we recall, the Twitter and News text sentiment analyses represented that, on average, the tweets are composed of text with greater negative sentiment than that of the news content. Therefore, our data has a fair mix of positive and negative text, which means that our labels will not be heavily imbalanced!  </span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true" tabindex="-1"></a><span class="fu">### Methods</span></span>
<span id="cb65-19"><a href="#cb65-19" aria-hidden="true" tabindex="-1"></a>Before we begin SVM modeling, we shall test our data on a random classifier, which is a baseline model, and output accuracy, precision, and recall values. We shall use sklearn's train-test split function to divide the data into an 80-20 train-test split respectively. Next, we shall employ the 4 aforementioned SVM models and compare their overall performance with each other. We shall also perform hyperparameter tuning, including changing the regularization values from 0.1 to 10 for all models and changing the Gamma values from 1 to 0.001 for all models excluding the Linear SVM. Our goal is to try to achieve even better performances from all the 4 models using hyperparameter tuning and comparing the tuned models with the initial SVM models. </span>
<span id="cb65-20"><a href="#cb65-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-21"><a href="#cb65-21" aria-hidden="true" tabindex="-1"></a><span class="fu">### Results</span></span>
<span id="cb65-22"><a href="#cb65-22" aria-hidden="true" tabindex="-1"></a>Our combined dataset of tweets and news content included a total of 380 observations. We tested support vector machines and a random classifier on this data. The hyperparameter tuned RBF and Sigmoid SVM models had the highest classification accuracies at 83% and 82% respectively. However, the lowest accuracy was obtained from the initial Sigmoid SVM model with 71% accuracy. Therefore, hyperparameter tuning is an important step in the machine learning process and it opens insights on why and how a particular model performs when its parameters are dialed back and forth.</span>
<span id="cb65-23"><a href="#cb65-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-24"><a href="#cb65-24" aria-hidden="true" tabindex="-1"></a><span class="fu">### Load the cleaned text data </span></span>
<span id="cb65-25"><a href="#cb65-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-28"><a href="#cb65-28" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb65-29"><a href="#cb65-29" aria-hidden="true" tabindex="-1"></a><span class="co">#| vscode: {languageId: python}</span></span>
<span id="cb65-30"><a href="#cb65-30" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb65-31"><a href="#cb65-31" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb65-32"><a href="#cb65-32" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb65-33"><a href="#cb65-33" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb65-34"><a href="#cb65-34" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix, ConfusionMatrixDisplay, classification_report</span>
<span id="cb65-35"><a href="#cb65-35" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb65-36"><a href="#cb65-36" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">"ignore"</span>)</span>
<span id="cb65-37"><a href="#cb65-37" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-38"><a href="#cb65-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-39"><a href="#cb65-39" aria-hidden="true" tabindex="-1"></a><span class="fu">### Exploring the dataset.</span></span>
<span id="cb65-40"><a href="#cb65-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-43"><a href="#cb65-43" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb65-44"><a href="#cb65-44" aria-hidden="true" tabindex="-1"></a><span class="co">#| vscode: {languageId: python}</span></span>
<span id="cb65-45"><a href="#cb65-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Import data and show first 5 rows</span></span>
<span id="cb65-46"><a href="#cb65-46" aria-hidden="true" tabindex="-1"></a>tweets_news_clean <span class="op">=</span> pd.read_csv(<span class="st">"../../data/Clean Data/Clean_Tweets_News_Merged.csv"</span>, index_col<span class="op">=</span>[<span class="dv">0</span>])</span>
<span id="cb65-47"><a href="#cb65-47" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-48"><a href="#cb65-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-51"><a href="#cb65-51" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb65-52"><a href="#cb65-52" aria-hidden="true" tabindex="-1"></a><span class="co">#| vscode: {languageId: python}</span></span>
<span id="cb65-53"><a href="#cb65-53" aria-hidden="true" tabindex="-1"></a>tweets_news_clean.head()</span>
<span id="cb65-54"><a href="#cb65-54" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-55"><a href="#cb65-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-58"><a href="#cb65-58" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb65-59"><a href="#cb65-59" aria-hidden="true" tabindex="-1"></a><span class="co">#| vscode: {languageId: python}</span></span>
<span id="cb65-60"><a href="#cb65-60" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Data shape is: "</span>, tweets_news_clean.shape)</span>
<span id="cb65-61"><a href="#cb65-61" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-62"><a href="#cb65-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-63"><a href="#cb65-63" aria-hidden="true" tabindex="-1"></a><span class="fu">### Split the dataset into training and testing sets</span></span>
<span id="cb65-64"><a href="#cb65-64" aria-hidden="true" tabindex="-1"></a>Sentiment is the dependent variable and the bag-of-words is our independent variable. The raw independent variable of lemmatized and cleaned texts of Twiiter and News API are turned into a bag-of-words document using CountVectorizer(). </span>
<span id="cb65-65"><a href="#cb65-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-68"><a href="#cb65-68" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb65-69"><a href="#cb65-69" aria-hidden="true" tabindex="-1"></a><span class="co">#| vscode: {languageId: python}</span></span>
<span id="cb65-70"><a href="#cb65-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the dataframe into X and y and then split X and y into train and test sets.</span></span>
<span id="cb65-71"><a href="#cb65-71" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb65-72"><a href="#cb65-72" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.feature_extraction.text <span class="im">import</span> CountVectorizer</span>
<span id="cb65-73"><a href="#cb65-73" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">3737</span>)</span>
<span id="cb65-74"><a href="#cb65-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-75"><a href="#cb65-75" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> tweets_news_clean[<span class="st">"Content_Lemmatized_Sentiment_Analysis"</span>]</span>
<span id="cb65-76"><a href="#cb65-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-77"><a href="#cb65-77" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> tweets_news_clean[<span class="st">"label"</span>]</span>
<span id="cb65-78"><a href="#cb65-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-79"><a href="#cb65-79" aria-hidden="true" tabindex="-1"></a>x_train, x_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, </span>
<span id="cb65-80"><a href="#cb65-80" aria-hidden="true" tabindex="-1"></a>    random_state <span class="op">=</span> <span class="dv">1</span>,test_size<span class="op">=</span><span class="fl">0.2</span></span>
<span id="cb65-81"><a href="#cb65-81" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb65-82"><a href="#cb65-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-83"><a href="#cb65-83" aria-hidden="true" tabindex="-1"></a>count_vector <span class="op">=</span> CountVectorizer()</span>
<span id="cb65-84"><a href="#cb65-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-85"><a href="#cb65-85" aria-hidden="true" tabindex="-1"></a>training_data <span class="op">=</span> count_vector.fit_transform(x_train)</span>
<span id="cb65-86"><a href="#cb65-86" aria-hidden="true" tabindex="-1"></a>testing_data <span class="op">=</span> count_vector.transform(x_test)</span>
<span id="cb65-87"><a href="#cb65-87" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-88"><a href="#cb65-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-91"><a href="#cb65-91" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb65-92"><a href="#cb65-92" aria-hidden="true" tabindex="-1"></a><span class="co">#| vscode: {languageId: python}</span></span>
<span id="cb65-93"><a href="#cb65-93" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the shape of the train and test sets, and levels of the dependent variable (Y) </span></span>
<span id="cb65-94"><a href="#cb65-94" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Shape of x_train is: "</span>, x_train.shape)</span>
<span id="cb65-95"><a href="#cb65-95" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Shape of x_test is: "</span>,x_test.shape)</span>
<span id="cb65-96"><a href="#cb65-96" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Shape of y_train is: "</span>,y_train.shape)</span>
<span id="cb65-97"><a href="#cb65-97" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Shape of y_test is: "</span>,y_test.shape)</span>
<span id="cb65-98"><a href="#cb65-98" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The levels of the dependent variable (Sentiment) are:"</span>)</span>
<span id="cb65-99"><a href="#cb65-99" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(y.value_counts())</span>
<span id="cb65-100"><a href="#cb65-100" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-101"><a href="#cb65-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-102"><a href="#cb65-102" aria-hidden="true" tabindex="-1"></a><span class="fu">## Baseline Classifier</span></span>
<span id="cb65-103"><a href="#cb65-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-106"><a href="#cb65-106" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb65-107"><a href="#cb65-107" aria-hidden="true" tabindex="-1"></a><span class="co">#| vscode: {languageId: python}</span></span>
<span id="cb65-108"><a href="#cb65-108" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb65-109"><a href="#cb65-109" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb65-110"><a href="#cb65-110" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> Counter</span>
<span id="cb65-111"><a href="#cb65-111" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score</span>
<span id="cb65-112"><a href="#cb65-112" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> precision_recall_fscore_support</span>
<span id="cb65-113"><a href="#cb65-113" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-114"><a href="#cb65-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-117"><a href="#cb65-117" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb65-118"><a href="#cb65-118" aria-hidden="true" tabindex="-1"></a><span class="co">#| vscode: {languageId: python}</span></span>
<span id="cb65-119"><a href="#cb65-119" aria-hidden="true" tabindex="-1"></a><span class="co">## RANDOM CLASSIFIER </span></span>
<span id="cb65-120"><a href="#cb65-120" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> random_classifier(y_data):</span>
<span id="cb65-121"><a href="#cb65-121" aria-hidden="true" tabindex="-1"></a>    ypred<span class="op">=</span>[]</span>
<span id="cb65-122"><a href="#cb65-122" aria-hidden="true" tabindex="-1"></a>    max_label<span class="op">=</span>np.<span class="bu">max</span>(y_data)<span class="op">;</span> <span class="co">#print(max_label)</span></span>
<span id="cb65-123"><a href="#cb65-123" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>,<span class="bu">len</span>(y_data)):</span>
<span id="cb65-124"><a href="#cb65-124" aria-hidden="true" tabindex="-1"></a>        ypred.append(<span class="bu">int</span>(np.floor((max_label<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>np.random.uniform(<span class="dv">0</span>,<span class="dv">1</span>))))</span>
<span id="cb65-125"><a href="#cb65-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-126"><a href="#cb65-126" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n\n</span><span class="st">-----RANDOM CLASSIFIER-----"</span>)</span>
<span id="cb65-127"><a href="#cb65-127" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"count of prediction:"</span>,Counter(ypred).values()) <span class="co"># counts the elements' frequency</span></span>
<span id="cb65-128"><a href="#cb65-128" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"probability of prediction:"</span>,np.fromiter(Counter(ypred).values(), dtype<span class="op">=</span><span class="bu">float</span>)<span class="op">/</span><span class="bu">len</span>(y_data)) <span class="co"># counts the elements' frequency</span></span>
<span id="cb65-129"><a href="#cb65-129" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"accuracy"</span>,accuracy_score(y_data, ypred))</span>
<span id="cb65-130"><a href="#cb65-130" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"precision, recall, fscore, support"</span>,precision_recall_fscore_support(y_data, ypred))</span>
<span id="cb65-131"><a href="#cb65-131" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-132"><a href="#cb65-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-135"><a href="#cb65-135" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb65-136"><a href="#cb65-136" aria-hidden="true" tabindex="-1"></a><span class="co">#| vscode: {languageId: python}</span></span>
<span id="cb65-137"><a href="#cb65-137" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> preprocessing</span>
<span id="cb65-138"><a href="#cb65-138" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-139"><a href="#cb65-139" aria-hidden="true" tabindex="-1"></a><span class="co"># label_encoder object knows how to understand word labels.</span></span>
<span id="cb65-140"><a href="#cb65-140" aria-hidden="true" tabindex="-1"></a>label_encoder <span class="op">=</span> preprocessing.LabelEncoder()</span>
<span id="cb65-141"><a href="#cb65-141" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-142"><a href="#cb65-142" aria-hidden="true" tabindex="-1"></a><span class="co"># Encode labels in column 'species'.</span></span>
<span id="cb65-143"><a href="#cb65-143" aria-hidden="true" tabindex="-1"></a>y_encoded <span class="op">=</span> label_encoder.fit_transform(y)</span>
<span id="cb65-144"><a href="#cb65-144" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-145"><a href="#cb65-145" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">BINARY CLASS: NON-UNIFORM LOAD (Positive: 175 count, Negative: 205 count"</span>)</span>
<span id="cb65-146"><a href="#cb65-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-147"><a href="#cb65-147" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Unique labels and respective counts after one-hot encoding: "</span>)</span>
<span id="cb65-148"><a href="#cb65-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-149"><a href="#cb65-149" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"0 = Negative and 1 = Positive"</span>)</span>
<span id="cb65-150"><a href="#cb65-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-151"><a href="#cb65-151" aria-hidden="true" tabindex="-1"></a>unique, counts <span class="op">=</span> np.unique(y_encoded, return_counts<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb65-152"><a href="#cb65-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-153"><a href="#cb65-153" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.asarray((unique, counts)).T)</span>
<span id="cb65-154"><a href="#cb65-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-155"><a href="#cb65-155" aria-hidden="true" tabindex="-1"></a>random_classifier(y_encoded)</span>
<span id="cb65-156"><a href="#cb65-156" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-157"><a href="#cb65-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-158"><a href="#cb65-158" aria-hidden="true" tabindex="-1"></a>The baseline classifier outputs an overall accuracy of 54% and an f-1 score of 0.57493857 for Negative labels and 0.50991501 for Positive labels respectively. The Linear SVM kernel should perform better than this, let's find out...</span>
<span id="cb65-159"><a href="#cb65-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-160"><a href="#cb65-160" aria-hidden="true" tabindex="-1"></a><span class="fu">## SVM with Linear kernels</span></span>
<span id="cb65-161"><a href="#cb65-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-164"><a href="#cb65-164" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb65-165"><a href="#cb65-165" aria-hidden="true" tabindex="-1"></a><span class="co">#| vscode: {languageId: python}</span></span>
<span id="cb65-166"><a href="#cb65-166" aria-hidden="true" tabindex="-1"></a><span class="co"># Import svc from sklearn.svm and classsification_report, confusion_matrix from sklearn.metrics.</span></span>
<span id="cb65-167"><a href="#cb65-167" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the classfier on the training data and predict on the test data. Set the classifier to be linear and C between 0.35-0.75. </span></span>
<span id="cb65-168"><a href="#cb65-168" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.svm <span class="im">import</span> SVC</span>
<span id="cb65-169"><a href="#cb65-169" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> SVC(C<span class="op">=</span><span class="fl">0.45</span>, kernel<span class="op">=</span><span class="st">'linear'</span>)</span>
<span id="cb65-170"><a href="#cb65-170" aria-hidden="true" tabindex="-1"></a>clf.fit(training_data, y_train)</span>
<span id="cb65-171"><a href="#cb65-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-172"><a href="#cb65-172" aria-hidden="true" tabindex="-1"></a>yp_train <span class="op">=</span> clf.predict(training_data)</span>
<span id="cb65-173"><a href="#cb65-173" aria-hidden="true" tabindex="-1"></a>yp_test <span class="op">=</span> clf.predict(testing_data)</span>
<span id="cb65-174"><a href="#cb65-174" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-175"><a href="#cb65-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-178"><a href="#cb65-178" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb65-179"><a href="#cb65-179" aria-hidden="true" tabindex="-1"></a><span class="co">#| vscode: {languageId: python}</span></span>
<span id="cb65-180"><a href="#cb65-180" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the confusion matrix and classification report for the train and test data. </span></span>
<span id="cb65-181"><a href="#cb65-181" aria-hidden="true" tabindex="-1"></a>cm_train <span class="op">=</span> confusion_matrix(y_train, yp_train, labels<span class="op">=</span>clf.classes_)</span>
<span id="cb65-182"><a href="#cb65-182" aria-hidden="true" tabindex="-1"></a>cm_test <span class="op">=</span> confusion_matrix(y_test, yp_test, labels<span class="op">=</span>clf.classes_)</span>
<span id="cb65-183"><a href="#cb65-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-184"><a href="#cb65-184" aria-hidden="true" tabindex="-1"></a>target_names <span class="op">=</span> [<span class="st">'Positive'</span>, <span class="st">'Negative'</span>]</span>
<span id="cb65-185"><a href="#cb65-185" aria-hidden="true" tabindex="-1"></a>clf_report_train_linear <span class="op">=</span> classification_report(y_train, yp_train, target_names<span class="op">=</span>target_names, output_dict<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb65-186"><a href="#cb65-186" aria-hidden="true" tabindex="-1"></a>clf_report_test_linear <span class="op">=</span> classification_report(y_test, yp_test, target_names<span class="op">=</span>target_names, output_dict<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb65-187"><a href="#cb65-187" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-188"><a href="#cb65-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-191"><a href="#cb65-191" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb65-192"><a href="#cb65-192" aria-hidden="true" tabindex="-1"></a><span class="co">#| vscode: {languageId: python}</span></span>
<span id="cb65-193"><a href="#cb65-193" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the results in a data frame. </span></span>
<span id="cb65-194"><a href="#cb65-194" aria-hidden="true" tabindex="-1"></a>clf_report_train_linear <span class="op">=</span> pd.DataFrame(clf_report_train_linear).transpose()</span>
<span id="cb65-195"><a href="#cb65-195" aria-hidden="true" tabindex="-1"></a>clf_report_test_linear <span class="op">=</span> pd.DataFrame(clf_report_test_linear).transpose()</span>
<span id="cb65-196"><a href="#cb65-196" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-197"><a href="#cb65-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-200"><a href="#cb65-200" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb65-201"><a href="#cb65-201" aria-hidden="true" tabindex="-1"></a><span class="co">#| vscode: {languageId: python}</span></span>
<span id="cb65-202"><a href="#cb65-202" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Classification Report of Linear SVM Train Data:"</span>)</span>
<span id="cb65-203"><a href="#cb65-203" aria-hidden="true" tabindex="-1"></a>clf_report_train_linear</span>
<span id="cb65-204"><a href="#cb65-204" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-205"><a href="#cb65-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-208"><a href="#cb65-208" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb65-209"><a href="#cb65-209" aria-hidden="true" tabindex="-1"></a><span class="co">#| vscode: {languageId: python}</span></span>
<span id="cb65-210"><a href="#cb65-210" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Classification Report of Linear SVM Test Data:"</span>)</span>
<span id="cb65-211"><a href="#cb65-211" aria-hidden="true" tabindex="-1"></a>clf_report_test_linear</span>
<span id="cb65-212"><a href="#cb65-212" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-213"><a href="#cb65-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-216"><a href="#cb65-216" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb65-217"><a href="#cb65-217" aria-hidden="true" tabindex="-1"></a><span class="co">#| vscode: {languageId: python}</span></span>
<span id="cb65-218"><a href="#cb65-218" aria-hidden="true" tabindex="-1"></a><span class="co"># Display Confusion Matrix for the test data. Remember to use the ConfusionMatrixDisplay function.</span></span>
<span id="cb65-219"><a href="#cb65-219" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">6</span>), dpi<span class="op">=</span><span class="dv">120</span>)</span>
<span id="cb65-220"><a href="#cb65-220" aria-hidden="true" tabindex="-1"></a>disp <span class="op">=</span> ConfusionMatrixDisplay(confusion_matrix<span class="op">=</span>cm_test, display_labels<span class="op">=</span>clf.classes_)</span>
<span id="cb65-221"><a href="#cb65-221" aria-hidden="true" tabindex="-1"></a>disp.plot(ax<span class="op">=</span>ax, cmap<span class="op">=</span>plt.cm.Blues, values_format<span class="op">=</span><span class="st">'d'</span>, xticks_rotation<span class="op">=</span><span class="st">'vertical'</span>)</span>
<span id="cb65-222"><a href="#cb65-222" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Confusion Matrix: Linear SVM Test Data"</span>)</span>
<span id="cb65-223"><a href="#cb65-223" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-224"><a href="#cb65-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-225"><a href="#cb65-225" aria-hidden="true" tabindex="-1"></a><span class="fu">### Hyper-parameter tuning using GridSearchCV: Evaluating Best SVC Regularization for Linear Kernel</span></span>
<span id="cb65-226"><a href="#cb65-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-229"><a href="#cb65-229" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb65-230"><a href="#cb65-230" aria-hidden="true" tabindex="-1"></a><span class="co">#| vscode: {languageId: python}</span></span>
<span id="cb65-231"><a href="#cb65-231" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.svm <span class="im">import</span> SVC</span>
<span id="cb65-232"><a href="#cb65-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-233"><a href="#cb65-233" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> GridSearchCV  </span>
<span id="cb65-234"><a href="#cb65-234" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-235"><a href="#cb65-235" aria-hidden="true" tabindex="-1"></a><span class="co"># defining parameter range</span></span>
<span id="cb65-236"><a href="#cb65-236" aria-hidden="true" tabindex="-1"></a>param_grid <span class="op">=</span> {<span class="st">'C'</span>: [<span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">0.7</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">10</span>], </span>
<span id="cb65-237"><a href="#cb65-237" aria-hidden="true" tabindex="-1"></a>              <span class="st">'kernel'</span>: [<span class="st">'linear'</span>]} </span>
<span id="cb65-238"><a href="#cb65-238" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-239"><a href="#cb65-239" aria-hidden="true" tabindex="-1"></a>grid <span class="op">=</span> GridSearchCV(SVC(), param_grid, refit <span class="op">=</span> <span class="va">True</span>, verbose <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb65-240"><a href="#cb65-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-241"><a href="#cb65-241" aria-hidden="true" tabindex="-1"></a>grid.fit(training_data, y_train)</span>
<span id="cb65-242"><a href="#cb65-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-243"><a href="#cb65-243" aria-hidden="true" tabindex="-1"></a><span class="co"># print best parameter after tuning</span></span>
<span id="cb65-244"><a href="#cb65-244" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The best parameters after tuning are: "</span>, grid.best_params_)</span>
<span id="cb65-245"><a href="#cb65-245" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-246"><a href="#cb65-246" aria-hidden="true" tabindex="-1"></a><span class="co"># print how our model looks after hyper-parameter tuning</span></span>
<span id="cb65-247"><a href="#cb65-247" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The best model after tuning looks like: "</span>,grid.best_estimator_)</span>
<span id="cb65-248"><a href="#cb65-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-249"><a href="#cb65-249" aria-hidden="true" tabindex="-1"></a>grid_predictions <span class="op">=</span> grid.predict(testing_data)</span>
<span id="cb65-250"><a href="#cb65-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-251"><a href="#cb65-251" aria-hidden="true" tabindex="-1"></a><span class="co"># print classification report</span></span>
<span id="cb65-252"><a href="#cb65-252" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_test, grid_predictions))</span>
<span id="cb65-253"><a href="#cb65-253" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-254"><a href="#cb65-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-257"><a href="#cb65-257" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb65-258"><a href="#cb65-258" aria-hidden="true" tabindex="-1"></a><span class="co">#| vscode: {languageId: python}</span></span>
<span id="cb65-259"><a href="#cb65-259" aria-hidden="true" tabindex="-1"></a><span class="co"># Display Confusion Matrix for the above hyperparameter model.</span></span>
<span id="cb65-260"><a href="#cb65-260" aria-hidden="true" tabindex="-1"></a>cm_test <span class="op">=</span> confusion_matrix(y_test, grid_predictions, labels<span class="op">=</span>grid.classes_)</span>
<span id="cb65-261"><a href="#cb65-261" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">6</span>), dpi<span class="op">=</span><span class="dv">120</span>)</span>
<span id="cb65-262"><a href="#cb65-262" aria-hidden="true" tabindex="-1"></a>disp <span class="op">=</span> ConfusionMatrixDisplay(confusion_matrix<span class="op">=</span>cm_test, display_labels<span class="op">=</span>clf.classes_)</span>
<span id="cb65-263"><a href="#cb65-263" aria-hidden="true" tabindex="-1"></a>disp.plot(ax<span class="op">=</span>ax, cmap<span class="op">=</span>plt.cm.Blues, values_format<span class="op">=</span><span class="st">'d'</span>, xticks_rotation<span class="op">=</span><span class="st">'vertical'</span>)</span>
<span id="cb65-264"><a href="#cb65-264" aria-hidden="true" tabindex="-1"></a>title_font <span class="op">=</span> {<span class="st">'size'</span>:<span class="st">'10'</span>}</span>
<span id="cb65-265"><a href="#cb65-265" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"GridSearchCV Confusion Matrix: Linear SVM Test Data"</span>, <span class="op">**</span>title_font)</span>
<span id="cb65-266"><a href="#cb65-266" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-267"><a href="#cb65-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-268"><a href="#cb65-268" aria-hidden="true" tabindex="-1"></a>Therefore, after performing hyperparameter tuning, the performance of the Linear SVM model remains same. This means that we had initially selected the best model before performing hyperparameter tuning for Linear SVM. Let's see if we can gain a better accuracy using Polynomial SVM kernels...</span>
<span id="cb65-269"><a href="#cb65-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-270"><a href="#cb65-270" aria-hidden="true" tabindex="-1"></a><span class="fu">## SVM with Polynomial kernels</span></span>
<span id="cb65-271"><a href="#cb65-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-274"><a href="#cb65-274" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb65-275"><a href="#cb65-275" aria-hidden="true" tabindex="-1"></a><span class="co">#| vscode: {languageId: python}</span></span>
<span id="cb65-276"><a href="#cb65-276" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the classfier on the training data and predict on the test data. Set the classifier to be polynomial.</span></span>
<span id="cb65-277"><a href="#cb65-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-278"><a href="#cb65-278" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> SVC(C<span class="op">=</span><span class="fl">0.45</span>, kernel <span class="op">=</span> <span class="st">'poly'</span>, degree<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb65-279"><a href="#cb65-279" aria-hidden="true" tabindex="-1"></a>clf.fit(training_data, y_train)</span>
<span id="cb65-280"><a href="#cb65-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-281"><a href="#cb65-281" aria-hidden="true" tabindex="-1"></a>yp_train <span class="op">=</span> clf.predict(training_data)</span>
<span id="cb65-282"><a href="#cb65-282" aria-hidden="true" tabindex="-1"></a>yp_test <span class="op">=</span> clf.predict(testing_data)</span>
<span id="cb65-283"><a href="#cb65-283" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-284"><a href="#cb65-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-287"><a href="#cb65-287" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb65-288"><a href="#cb65-288" aria-hidden="true" tabindex="-1"></a><span class="co">#| vscode: {languageId: python}</span></span>
<span id="cb65-289"><a href="#cb65-289" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the confusion matrix and classification report for the train and test data. </span></span>
<span id="cb65-290"><a href="#cb65-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-291"><a href="#cb65-291" aria-hidden="true" tabindex="-1"></a>cm_train <span class="op">=</span> confusion_matrix(y_train, yp_train, labels<span class="op">=</span>clf.classes_)</span>
<span id="cb65-292"><a href="#cb65-292" aria-hidden="true" tabindex="-1"></a>cm_test <span class="op">=</span> confusion_matrix(y_test, yp_test, labels<span class="op">=</span>clf.classes_)</span>
<span id="cb65-293"><a href="#cb65-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-294"><a href="#cb65-294" aria-hidden="true" tabindex="-1"></a>clf_report_train_poly <span class="op">=</span> classification_report(y_train, yp_train, target_names<span class="op">=</span>target_names, output_dict<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb65-295"><a href="#cb65-295" aria-hidden="true" tabindex="-1"></a>clf_report_test_poly <span class="op">=</span> classification_report(y_test, yp_test, target_names<span class="op">=</span>target_names, output_dict<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb65-296"><a href="#cb65-296" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-297"><a href="#cb65-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-300"><a href="#cb65-300" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb65-301"><a href="#cb65-301" aria-hidden="true" tabindex="-1"></a><span class="co">#| vscode: {languageId: python}</span></span>
<span id="cb65-302"><a href="#cb65-302" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the results in a data frame.</span></span>
<span id="cb65-303"><a href="#cb65-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-304"><a href="#cb65-304" aria-hidden="true" tabindex="-1"></a>clf_report_train_poly <span class="op">=</span> pd.DataFrame(clf_report_train_poly).transpose()</span>
<span id="cb65-305"><a href="#cb65-305" aria-hidden="true" tabindex="-1"></a>clf_report_test_poly <span class="op">=</span> pd.DataFrame(clf_report_test_poly).transpose()</span>
<span id="cb65-306"><a href="#cb65-306" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-307"><a href="#cb65-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-310"><a href="#cb65-310" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb65-311"><a href="#cb65-311" aria-hidden="true" tabindex="-1"></a><span class="co">#| vscode: {languageId: python}</span></span>
<span id="cb65-312"><a href="#cb65-312" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Classification Report of Polynomial SVM Train Data:"</span>)</span>
<span id="cb65-313"><a href="#cb65-313" aria-hidden="true" tabindex="-1"></a>clf_report_train_poly</span>
<span id="cb65-314"><a href="#cb65-314" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-315"><a href="#cb65-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-318"><a href="#cb65-318" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb65-319"><a href="#cb65-319" aria-hidden="true" tabindex="-1"></a><span class="co">#| vscode: {languageId: python}</span></span>
<span id="cb65-320"><a href="#cb65-320" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Classification Report of Polynomial SVM Test Data:"</span>)</span>
<span id="cb65-321"><a href="#cb65-321" aria-hidden="true" tabindex="-1"></a>clf_report_test_poly</span>
<span id="cb65-322"><a href="#cb65-322" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-323"><a href="#cb65-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-326"><a href="#cb65-326" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb65-327"><a href="#cb65-327" aria-hidden="true" tabindex="-1"></a><span class="co">#| vscode: {languageId: python}</span></span>
<span id="cb65-328"><a href="#cb65-328" aria-hidden="true" tabindex="-1"></a><span class="co"># Display Confusion Matrix for the test data. Remember to use the ConfusionMatrixDisplay function.</span></span>
<span id="cb65-329"><a href="#cb65-329" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">6</span>), dpi<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb65-330"><a href="#cb65-330" aria-hidden="true" tabindex="-1"></a>disp <span class="op">=</span> ConfusionMatrixDisplay(confusion_matrix<span class="op">=</span>cm_test, display_labels<span class="op">=</span>clf.classes_)</span>
<span id="cb65-331"><a href="#cb65-331" aria-hidden="true" tabindex="-1"></a>disp.plot(ax<span class="op">=</span>ax, cmap<span class="op">=</span>plt.cm.Blues, values_format<span class="op">=</span><span class="st">'d'</span>, xticks_rotation<span class="op">=</span><span class="st">'vertical'</span>)</span>
<span id="cb65-332"><a href="#cb65-332" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Confusion Matrix: Polynomial SVM Test Data"</span>)</span>
<span id="cb65-333"><a href="#cb65-333" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-334"><a href="#cb65-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-335"><a href="#cb65-335" aria-hidden="true" tabindex="-1"></a><span class="fu">### Hyper-parameter tuning using GridSearchCV: Evaluating Best SVC Regularization and Gamma for Poly Kernel</span></span>
<span id="cb65-336"><a href="#cb65-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-339"><a href="#cb65-339" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb65-340"><a href="#cb65-340" aria-hidden="true" tabindex="-1"></a><span class="co">#| vscode: {languageId: python}</span></span>
<span id="cb65-341"><a href="#cb65-341" aria-hidden="true" tabindex="-1"></a><span class="co"># defining parameter range</span></span>
<span id="cb65-342"><a href="#cb65-342" aria-hidden="true" tabindex="-1"></a>param_grid <span class="op">=</span> {<span class="st">'C'</span>: [<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">5</span>], </span>
<span id="cb65-343"><a href="#cb65-343" aria-hidden="true" tabindex="-1"></a>              <span class="st">'gamma'</span>: [<span class="dv">1</span>, <span class="fl">0.1</span>, <span class="fl">0.01</span>, <span class="fl">0.001</span>],</span>
<span id="cb65-344"><a href="#cb65-344" aria-hidden="true" tabindex="-1"></a>              <span class="st">'kernel'</span>: [<span class="st">'poly'</span>]} </span>
<span id="cb65-345"><a href="#cb65-345" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-346"><a href="#cb65-346" aria-hidden="true" tabindex="-1"></a>grid <span class="op">=</span> GridSearchCV(SVC(), param_grid, refit <span class="op">=</span> <span class="va">True</span>, verbose <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb65-347"><a href="#cb65-347" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-348"><a href="#cb65-348" aria-hidden="true" tabindex="-1"></a>grid.fit(training_data, y_train)</span>
<span id="cb65-349"><a href="#cb65-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-350"><a href="#cb65-350" aria-hidden="true" tabindex="-1"></a><span class="co"># print best parameter after tuning</span></span>
<span id="cb65-351"><a href="#cb65-351" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The best parameters after tuning are: "</span>, grid.best_params_)</span>
<span id="cb65-352"><a href="#cb65-352" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-353"><a href="#cb65-353" aria-hidden="true" tabindex="-1"></a><span class="co"># print how our model looks after hyper-parameter tuning</span></span>
<span id="cb65-354"><a href="#cb65-354" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The best model after tuning looks like: "</span>,grid.best_estimator_)</span>
<span id="cb65-355"><a href="#cb65-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-356"><a href="#cb65-356" aria-hidden="true" tabindex="-1"></a>grid_predictions <span class="op">=</span> grid.predict(testing_data)</span>
<span id="cb65-357"><a href="#cb65-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-358"><a href="#cb65-358" aria-hidden="true" tabindex="-1"></a><span class="co"># print classification report</span></span>
<span id="cb65-359"><a href="#cb65-359" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_test, grid_predictions))</span>
<span id="cb65-360"><a href="#cb65-360" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-361"><a href="#cb65-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-364"><a href="#cb65-364" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb65-365"><a href="#cb65-365" aria-hidden="true" tabindex="-1"></a><span class="co">#| vscode: {languageId: python}</span></span>
<span id="cb65-366"><a href="#cb65-366" aria-hidden="true" tabindex="-1"></a><span class="co"># Display Confusion Matrix for the above hyperparameter model.</span></span>
<span id="cb65-367"><a href="#cb65-367" aria-hidden="true" tabindex="-1"></a>cm_test <span class="op">=</span> confusion_matrix(y_test, grid_predictions, labels<span class="op">=</span>grid.classes_)</span>
<span id="cb65-368"><a href="#cb65-368" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">6</span>), dpi<span class="op">=</span><span class="dv">120</span>)</span>
<span id="cb65-369"><a href="#cb65-369" aria-hidden="true" tabindex="-1"></a>disp <span class="op">=</span> ConfusionMatrixDisplay(confusion_matrix<span class="op">=</span>cm_test, display_labels<span class="op">=</span>clf.classes_)</span>
<span id="cb65-370"><a href="#cb65-370" aria-hidden="true" tabindex="-1"></a>disp.plot(ax<span class="op">=</span>ax, cmap<span class="op">=</span>plt.cm.Blues, values_format<span class="op">=</span><span class="st">'d'</span>, xticks_rotation<span class="op">=</span><span class="st">'vertical'</span>)</span>
<span id="cb65-371"><a href="#cb65-371" aria-hidden="true" tabindex="-1"></a>title_font <span class="op">=</span> {<span class="st">'size'</span>:<span class="st">'10'</span>}</span>
<span id="cb65-372"><a href="#cb65-372" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"GridSearchCV Confusion Matrix: Polynomial SVM Test Data"</span>, <span class="op">**</span>title_font)</span>
<span id="cb65-373"><a href="#cb65-373" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-374"><a href="#cb65-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-375"><a href="#cb65-375" aria-hidden="true" tabindex="-1"></a>Therefore, after performing hyperparameter tuning, the performance of the Polynomial SVM model remains same. This means that we had initially selected the best model before performing hyperparameter tuning for Polynomial SVM. Even after setting different gamma values and regularization parameters, the initial model is as good as the hyperparameterized model. Moreover, the weighted overall accuracy is 3% lower than that of the Linear SVM models! Probably our "easy-to-learn" data does not require more complex models than Linear SVM. However, let's see if we can still gain a better accuracy using RBF SVM kernels (best-performing SVM kernel)...</span>
<span id="cb65-376"><a href="#cb65-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-377"><a href="#cb65-377" aria-hidden="true" tabindex="-1"></a><span class="fu">## SVM with RBF kernels</span></span>
<span id="cb65-378"><a href="#cb65-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-381"><a href="#cb65-381" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb65-382"><a href="#cb65-382" aria-hidden="true" tabindex="-1"></a><span class="co">#| vscode: {languageId: python}</span></span>
<span id="cb65-383"><a href="#cb65-383" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the classfier on the training data and predict on the test data. Set the classifier to be linear and C between 0.35-0.75. </span></span>
<span id="cb65-384"><a href="#cb65-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-385"><a href="#cb65-385" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> SVC(C<span class="op">=</span><span class="fl">0.45</span>, kernel <span class="op">=</span> <span class="st">'rbf'</span>)</span>
<span id="cb65-386"><a href="#cb65-386" aria-hidden="true" tabindex="-1"></a>clf.fit(training_data, y_train)</span>
<span id="cb65-387"><a href="#cb65-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-388"><a href="#cb65-388" aria-hidden="true" tabindex="-1"></a>yp_train <span class="op">=</span> clf.predict(training_data)</span>
<span id="cb65-389"><a href="#cb65-389" aria-hidden="true" tabindex="-1"></a>yp_test <span class="op">=</span> clf.predict(testing_data)</span>
<span id="cb65-390"><a href="#cb65-390" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-391"><a href="#cb65-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-394"><a href="#cb65-394" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb65-395"><a href="#cb65-395" aria-hidden="true" tabindex="-1"></a><span class="co">#| vscode: {languageId: python}</span></span>
<span id="cb65-396"><a href="#cb65-396" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the confusion matrix and classification report for the train and test data. </span></span>
<span id="cb65-397"><a href="#cb65-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-398"><a href="#cb65-398" aria-hidden="true" tabindex="-1"></a>cm_train <span class="op">=</span> confusion_matrix(y_train, yp_train, labels<span class="op">=</span>clf.classes_)</span>
<span id="cb65-399"><a href="#cb65-399" aria-hidden="true" tabindex="-1"></a>cm_test <span class="op">=</span> confusion_matrix(y_test, yp_test, labels<span class="op">=</span>clf.classes_)</span>
<span id="cb65-400"><a href="#cb65-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-401"><a href="#cb65-401" aria-hidden="true" tabindex="-1"></a>clf_report_train_RBF <span class="op">=</span> classification_report(y_train, yp_train, target_names<span class="op">=</span>target_names, output_dict<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb65-402"><a href="#cb65-402" aria-hidden="true" tabindex="-1"></a>clf_report_test_RBF <span class="op">=</span> classification_report(y_test, yp_test, target_names<span class="op">=</span>target_names, output_dict<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb65-403"><a href="#cb65-403" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-404"><a href="#cb65-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-407"><a href="#cb65-407" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb65-408"><a href="#cb65-408" aria-hidden="true" tabindex="-1"></a><span class="co">#| vscode: {languageId: python}</span></span>
<span id="cb65-409"><a href="#cb65-409" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the results in a data frame.</span></span>
<span id="cb65-410"><a href="#cb65-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-411"><a href="#cb65-411" aria-hidden="true" tabindex="-1"></a>clf_report_train_RBF <span class="op">=</span> pd.DataFrame(clf_report_train_RBF).transpose()</span>
<span id="cb65-412"><a href="#cb65-412" aria-hidden="true" tabindex="-1"></a>clf_report_test_RBF <span class="op">=</span> pd.DataFrame(clf_report_test_RBF).transpose()</span>
<span id="cb65-413"><a href="#cb65-413" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-414"><a href="#cb65-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-417"><a href="#cb65-417" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb65-418"><a href="#cb65-418" aria-hidden="true" tabindex="-1"></a><span class="co">#| vscode: {languageId: python}</span></span>
<span id="cb65-419"><a href="#cb65-419" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Classification Report of RBF SVM Train Data:"</span>)</span>
<span id="cb65-420"><a href="#cb65-420" aria-hidden="true" tabindex="-1"></a>clf_report_train_RBF</span>
<span id="cb65-421"><a href="#cb65-421" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-422"><a href="#cb65-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-425"><a href="#cb65-425" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb65-426"><a href="#cb65-426" aria-hidden="true" tabindex="-1"></a><span class="co">#| vscode: {languageId: python}</span></span>
<span id="cb65-427"><a href="#cb65-427" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Classification Report of RBF SVM Test Data:"</span>)</span>
<span id="cb65-428"><a href="#cb65-428" aria-hidden="true" tabindex="-1"></a>clf_report_test_RBF</span>
<span id="cb65-429"><a href="#cb65-429" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-430"><a href="#cb65-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-433"><a href="#cb65-433" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb65-434"><a href="#cb65-434" aria-hidden="true" tabindex="-1"></a><span class="co">#| vscode: {languageId: python}</span></span>
<span id="cb65-435"><a href="#cb65-435" aria-hidden="true" tabindex="-1"></a><span class="co"># Display Confusion Matrix for the test data. Remember to use the ConfusionMatrixDisplay function.</span></span>
<span id="cb65-436"><a href="#cb65-436" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">6</span>), dpi<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb65-437"><a href="#cb65-437" aria-hidden="true" tabindex="-1"></a>disp <span class="op">=</span> ConfusionMatrixDisplay(confusion_matrix<span class="op">=</span>cm_test, display_labels<span class="op">=</span>clf.classes_)</span>
<span id="cb65-438"><a href="#cb65-438" aria-hidden="true" tabindex="-1"></a>disp.plot(ax<span class="op">=</span>ax, cmap<span class="op">=</span>plt.cm.Blues, values_format<span class="op">=</span><span class="st">'d'</span>, xticks_rotation<span class="op">=</span><span class="st">'vertical'</span>)</span>
<span id="cb65-439"><a href="#cb65-439" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Confusion Matrix: RBF SVM Test Data"</span>)</span>
<span id="cb65-440"><a href="#cb65-440" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-441"><a href="#cb65-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-442"><a href="#cb65-442" aria-hidden="true" tabindex="-1"></a><span class="fu">### Hyper-parameter tuning using GridSearchCV: Evaluating Best SVC Regularization and Gamma for RBF Kernel</span></span>
<span id="cb65-443"><a href="#cb65-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-446"><a href="#cb65-446" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb65-447"><a href="#cb65-447" aria-hidden="true" tabindex="-1"></a><span class="co">#| vscode: {languageId: python}</span></span>
<span id="cb65-448"><a href="#cb65-448" aria-hidden="true" tabindex="-1"></a><span class="co"># defining parameter range</span></span>
<span id="cb65-449"><a href="#cb65-449" aria-hidden="true" tabindex="-1"></a>param_grid <span class="op">=</span> {<span class="st">'C'</span>: [<span class="fl">0.1</span>, <span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">1000</span>], </span>
<span id="cb65-450"><a href="#cb65-450" aria-hidden="true" tabindex="-1"></a>              <span class="st">'gamma'</span>: [<span class="dv">1</span>, <span class="fl">0.1</span>, <span class="fl">0.01</span>, <span class="fl">0.001</span>, <span class="fl">0.0001</span>],</span>
<span id="cb65-451"><a href="#cb65-451" aria-hidden="true" tabindex="-1"></a>              <span class="st">'kernel'</span>: [<span class="st">'rbf'</span>]}</span>
<span id="cb65-452"><a href="#cb65-452" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-453"><a href="#cb65-453" aria-hidden="true" tabindex="-1"></a>grid <span class="op">=</span> GridSearchCV(SVC(), param_grid, refit <span class="op">=</span> <span class="va">True</span>, verbose <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb65-454"><a href="#cb65-454" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-455"><a href="#cb65-455" aria-hidden="true" tabindex="-1"></a>grid.fit(training_data, y_train)</span>
<span id="cb65-456"><a href="#cb65-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-457"><a href="#cb65-457" aria-hidden="true" tabindex="-1"></a><span class="co"># print best parameter after tuning</span></span>
<span id="cb65-458"><a href="#cb65-458" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The best parameters after tuning are: "</span>, grid.best_params_)</span>
<span id="cb65-459"><a href="#cb65-459" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-460"><a href="#cb65-460" aria-hidden="true" tabindex="-1"></a><span class="co"># print how our model looks after hyper-parameter tuning</span></span>
<span id="cb65-461"><a href="#cb65-461" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The best model after tuning looks like: "</span>,grid.best_estimator_)</span>
<span id="cb65-462"><a href="#cb65-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-463"><a href="#cb65-463" aria-hidden="true" tabindex="-1"></a>grid_predictions <span class="op">=</span> grid.predict(testing_data)</span>
<span id="cb65-464"><a href="#cb65-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-465"><a href="#cb65-465" aria-hidden="true" tabindex="-1"></a><span class="co"># print classification report</span></span>
<span id="cb65-466"><a href="#cb65-466" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_test, grid_predictions))</span>
<span id="cb65-467"><a href="#cb65-467" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-468"><a href="#cb65-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-471"><a href="#cb65-471" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb65-472"><a href="#cb65-472" aria-hidden="true" tabindex="-1"></a><span class="co">#| vscode: {languageId: python}</span></span>
<span id="cb65-473"><a href="#cb65-473" aria-hidden="true" tabindex="-1"></a><span class="co"># Display Confusion Matrix for the above hyperparameter model.</span></span>
<span id="cb65-474"><a href="#cb65-474" aria-hidden="true" tabindex="-1"></a>cm_test <span class="op">=</span> confusion_matrix(y_test, grid_predictions, labels<span class="op">=</span>grid.classes_)</span>
<span id="cb65-475"><a href="#cb65-475" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">6</span>), dpi<span class="op">=</span><span class="dv">120</span>)</span>
<span id="cb65-476"><a href="#cb65-476" aria-hidden="true" tabindex="-1"></a>disp <span class="op">=</span> ConfusionMatrixDisplay(confusion_matrix<span class="op">=</span>cm_test, display_labels<span class="op">=</span>clf.classes_)</span>
<span id="cb65-477"><a href="#cb65-477" aria-hidden="true" tabindex="-1"></a>disp.plot(ax<span class="op">=</span>ax, cmap<span class="op">=</span>plt.cm.Blues, values_format<span class="op">=</span><span class="st">'d'</span>, xticks_rotation<span class="op">=</span><span class="st">'vertical'</span>)</span>
<span id="cb65-478"><a href="#cb65-478" aria-hidden="true" tabindex="-1"></a>title_font <span class="op">=</span> {<span class="st">'size'</span>:<span class="st">'10'</span>}</span>
<span id="cb65-479"><a href="#cb65-479" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"GridSearchCV Confusion Matrix: RBF SVM Test Data"</span>, <span class="op">**</span>title_font)</span>
<span id="cb65-480"><a href="#cb65-480" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-481"><a href="#cb65-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-482"><a href="#cb65-482" aria-hidden="true" tabindex="-1"></a>Therefore, after performing hyperparameter tuning, the performance of the RBF SVM model increased! This means that our initially selected model had scope for improvement in terms of weighted accuracy and f-1 score. Moreover, the hyperparameter tuned Polynomial SVM performed better than all other SVM models.The weighted overall accuracy is 4% higher than that of the initial RBF SVM model! As mentioned, earlier, the RBF SVM  is the best-performing kernel and we have reinforced it through the above analysis. Now, let's see if we can at least match RBF SVM's performance using a Sigmoid SVM kernel...</span>
<span id="cb65-483"><a href="#cb65-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-484"><a href="#cb65-484" aria-hidden="true" tabindex="-1"></a><span class="fu">## SVM with Sigmoid Kernels</span></span>
<span id="cb65-485"><a href="#cb65-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-488"><a href="#cb65-488" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb65-489"><a href="#cb65-489" aria-hidden="true" tabindex="-1"></a><span class="co">#| vscode: {languageId: python}</span></span>
<span id="cb65-490"><a href="#cb65-490" aria-hidden="true" tabindex="-1"></a><span class="co"># Import svc from sklearn.svm and classsification_report, confusion_matrix from sklearn.metrics.</span></span>
<span id="cb65-491"><a href="#cb65-491" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the classfier on the training data and predict on the test data. Set the classifier to be linear and C between 0.35-0.75. </span></span>
<span id="cb65-492"><a href="#cb65-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-493"><a href="#cb65-493" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> SVC(C<span class="op">=</span><span class="fl">0.45</span>, kernel <span class="op">=</span> <span class="st">'sigmoid'</span>)</span>
<span id="cb65-494"><a href="#cb65-494" aria-hidden="true" tabindex="-1"></a>clf.fit(training_data, y_train)</span>
<span id="cb65-495"><a href="#cb65-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-496"><a href="#cb65-496" aria-hidden="true" tabindex="-1"></a>yp_train <span class="op">=</span> clf.predict(training_data)</span>
<span id="cb65-497"><a href="#cb65-497" aria-hidden="true" tabindex="-1"></a>yp_test <span class="op">=</span> clf.predict(testing_data)</span>
<span id="cb65-498"><a href="#cb65-498" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-499"><a href="#cb65-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-502"><a href="#cb65-502" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb65-503"><a href="#cb65-503" aria-hidden="true" tabindex="-1"></a><span class="co">#| vscode: {languageId: python}</span></span>
<span id="cb65-504"><a href="#cb65-504" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the confusion matrix and classification report for the train and test data. </span></span>
<span id="cb65-505"><a href="#cb65-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-506"><a href="#cb65-506" aria-hidden="true" tabindex="-1"></a>cm_train <span class="op">=</span> confusion_matrix(y_train, yp_train, labels<span class="op">=</span>clf.classes_)</span>
<span id="cb65-507"><a href="#cb65-507" aria-hidden="true" tabindex="-1"></a>cm_test <span class="op">=</span> confusion_matrix(y_test, yp_test, labels<span class="op">=</span>clf.classes_)</span>
<span id="cb65-508"><a href="#cb65-508" aria-hidden="true" tabindex="-1"></a>clf_report_train_sigmoid <span class="op">=</span> classification_report(y_train, yp_train, target_names<span class="op">=</span>target_names, output_dict<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb65-509"><a href="#cb65-509" aria-hidden="true" tabindex="-1"></a>clf_report_test_sigmoid <span class="op">=</span> classification_report(y_test, yp_test, target_names<span class="op">=</span>target_names, output_dict<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb65-510"><a href="#cb65-510" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-511"><a href="#cb65-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-514"><a href="#cb65-514" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb65-515"><a href="#cb65-515" aria-hidden="true" tabindex="-1"></a><span class="co">#| vscode: {languageId: python}</span></span>
<span id="cb65-516"><a href="#cb65-516" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the results in a data frame.</span></span>
<span id="cb65-517"><a href="#cb65-517" aria-hidden="true" tabindex="-1"></a>clf_report_train_sigmoid <span class="op">=</span> pd.DataFrame(clf_report_train_sigmoid).transpose()</span>
<span id="cb65-518"><a href="#cb65-518" aria-hidden="true" tabindex="-1"></a>clf_report_test_sigmoid <span class="op">=</span> pd.DataFrame(clf_report_test_sigmoid).transpose()</span>
<span id="cb65-519"><a href="#cb65-519" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-520"><a href="#cb65-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-523"><a href="#cb65-523" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb65-524"><a href="#cb65-524" aria-hidden="true" tabindex="-1"></a><span class="co">#| vscode: {languageId: python}</span></span>
<span id="cb65-525"><a href="#cb65-525" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Classification Report of Sigmoid SVM Train Data:"</span>)</span>
<span id="cb65-526"><a href="#cb65-526" aria-hidden="true" tabindex="-1"></a>clf_report_train_sigmoid </span>
<span id="cb65-527"><a href="#cb65-527" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-528"><a href="#cb65-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-531"><a href="#cb65-531" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb65-532"><a href="#cb65-532" aria-hidden="true" tabindex="-1"></a><span class="co">#| vscode: {languageId: python}</span></span>
<span id="cb65-533"><a href="#cb65-533" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Classification Report of Sigmoid SVM Test Data:"</span>)</span>
<span id="cb65-534"><a href="#cb65-534" aria-hidden="true" tabindex="-1"></a>clf_report_test_sigmoid </span>
<span id="cb65-535"><a href="#cb65-535" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-536"><a href="#cb65-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-539"><a href="#cb65-539" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb65-540"><a href="#cb65-540" aria-hidden="true" tabindex="-1"></a><span class="co">#| vscode: {languageId: python}</span></span>
<span id="cb65-541"><a href="#cb65-541" aria-hidden="true" tabindex="-1"></a><span class="co"># Display Confusion Matrix for the test data. Remember to use the ConfusionMatrixDisplay function.</span></span>
<span id="cb65-542"><a href="#cb65-542" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">6</span>), dpi<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb65-543"><a href="#cb65-543" aria-hidden="true" tabindex="-1"></a>disp <span class="op">=</span> ConfusionMatrixDisplay(confusion_matrix<span class="op">=</span>cm_test, display_labels<span class="op">=</span>clf.classes_)</span>
<span id="cb65-544"><a href="#cb65-544" aria-hidden="true" tabindex="-1"></a>disp.plot(ax<span class="op">=</span>ax, cmap<span class="op">=</span>plt.cm.Blues, values_format<span class="op">=</span><span class="st">'d'</span>, xticks_rotation<span class="op">=</span><span class="st">'vertical'</span>)</span>
<span id="cb65-545"><a href="#cb65-545" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-546"><a href="#cb65-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-547"><a href="#cb65-547" aria-hidden="true" tabindex="-1"></a><span class="fu">### Hyper-parameter tuning using GridSearchCV: Evaluating Best SVC Regularization and Gamma for Sigmoid Kernel</span></span>
<span id="cb65-548"><a href="#cb65-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-551"><a href="#cb65-551" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb65-552"><a href="#cb65-552" aria-hidden="true" tabindex="-1"></a><span class="co">#| vscode: {languageId: python}</span></span>
<span id="cb65-553"><a href="#cb65-553" aria-hidden="true" tabindex="-1"></a><span class="co"># defining parameter range</span></span>
<span id="cb65-554"><a href="#cb65-554" aria-hidden="true" tabindex="-1"></a>param_grid <span class="op">=</span> {<span class="st">'C'</span>: [<span class="fl">0.1</span>, <span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">1000</span>], </span>
<span id="cb65-555"><a href="#cb65-555" aria-hidden="true" tabindex="-1"></a>              <span class="st">'gamma'</span>: [<span class="dv">1</span>, <span class="fl">0.1</span>, <span class="fl">0.01</span>, <span class="fl">0.001</span>, <span class="fl">0.0001</span>],</span>
<span id="cb65-556"><a href="#cb65-556" aria-hidden="true" tabindex="-1"></a>              <span class="st">'kernel'</span>: [<span class="st">'sigmoid'</span>]}</span>
<span id="cb65-557"><a href="#cb65-557" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-558"><a href="#cb65-558" aria-hidden="true" tabindex="-1"></a>grid <span class="op">=</span> GridSearchCV(SVC(), param_grid, refit <span class="op">=</span> <span class="va">True</span>, verbose <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb65-559"><a href="#cb65-559" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-560"><a href="#cb65-560" aria-hidden="true" tabindex="-1"></a>grid.fit(training_data, y_train)</span>
<span id="cb65-561"><a href="#cb65-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-562"><a href="#cb65-562" aria-hidden="true" tabindex="-1"></a><span class="co"># print best parameter after tuning</span></span>
<span id="cb65-563"><a href="#cb65-563" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The best parameters after tuning are: "</span>, grid.best_params_)</span>
<span id="cb65-564"><a href="#cb65-564" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-565"><a href="#cb65-565" aria-hidden="true" tabindex="-1"></a><span class="co"># print how our model looks after hyper-parameter tuning</span></span>
<span id="cb65-566"><a href="#cb65-566" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The best model after tuning looks like: "</span>,grid.best_estimator_)</span>
<span id="cb65-567"><a href="#cb65-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-568"><a href="#cb65-568" aria-hidden="true" tabindex="-1"></a>grid_predictions <span class="op">=</span> grid.predict(testing_data)</span>
<span id="cb65-569"><a href="#cb65-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-570"><a href="#cb65-570" aria-hidden="true" tabindex="-1"></a><span class="co"># print classification report</span></span>
<span id="cb65-571"><a href="#cb65-571" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_test, grid_predictions))</span>
<span id="cb65-572"><a href="#cb65-572" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-573"><a href="#cb65-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-576"><a href="#cb65-576" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb65-577"><a href="#cb65-577" aria-hidden="true" tabindex="-1"></a><span class="co">#| vscode: {languageId: python}</span></span>
<span id="cb65-578"><a href="#cb65-578" aria-hidden="true" tabindex="-1"></a><span class="co"># Display Confusion Matrix for the above hyperparameter model.</span></span>
<span id="cb65-579"><a href="#cb65-579" aria-hidden="true" tabindex="-1"></a>cm_test <span class="op">=</span> confusion_matrix(y_test, grid_predictions, labels<span class="op">=</span>grid.classes_)</span>
<span id="cb65-580"><a href="#cb65-580" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">6</span>), dpi<span class="op">=</span><span class="dv">120</span>)</span>
<span id="cb65-581"><a href="#cb65-581" aria-hidden="true" tabindex="-1"></a>disp <span class="op">=</span> ConfusionMatrixDisplay(confusion_matrix<span class="op">=</span>cm_test, display_labels<span class="op">=</span>clf.classes_)</span>
<span id="cb65-582"><a href="#cb65-582" aria-hidden="true" tabindex="-1"></a>disp.plot(ax<span class="op">=</span>ax, cmap<span class="op">=</span>plt.cm.Blues, values_format<span class="op">=</span><span class="st">'d'</span>, xticks_rotation<span class="op">=</span><span class="st">'vertical'</span>)</span>
<span id="cb65-583"><a href="#cb65-583" aria-hidden="true" tabindex="-1"></a>title_font <span class="op">=</span> {<span class="st">'size'</span>:<span class="st">'10'</span>}</span>
<span id="cb65-584"><a href="#cb65-584" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"GridSearchCV Confusion Matrix: Sigmoid SVM Test Data"</span>, <span class="op">**</span>title_font)</span>
<span id="cb65-585"><a href="#cb65-585" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-586"><a href="#cb65-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-587"><a href="#cb65-587" aria-hidden="true" tabindex="-1"></a>Therefore, after performing hyperparameter tuning, the performance of the Sigmoid SVM model increased and the increase in performance is almost as good as the hyperparameter tuned RBF model! Surprisingly, the initial Sigmoid SVM's performance was the worst out of all other models! This means that our initially selected model indubitably had scope for improvement in terms of weighted accuracy and f-1 score. The weighted overall accuracy of the Sigmoid hyperparameter tuned model is 11% higher than that of the initial Sigmoid SVM model! The overall results of this analysis help us conclude that the RBF and Sigmoid SVM's are the most powerful when it comes to predicting labeled text data that has been transformed into a bag-of-words using count vectorizer. </span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>